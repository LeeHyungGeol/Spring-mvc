package com.brothergeol.servlet.web.frontcontroller.v5.adapter;import com.brothergeol.servlet.web.frontcontroller.ModelView;import com.brothergeol.servlet.web.frontcontroller.MyView;import com.brothergeol.servlet.web.frontcontroller.v2.ControllerV2;import com.brothergeol.servlet.web.frontcontroller.v5.MyHandlerAdapter;import jakarta.servlet.ServletException;import jakarta.servlet.http.HttpServletRequest;import jakarta.servlet.http.HttpServletResponse;import java.io.IOException;import java.util.HashMap;import java.util.Map;public class ControllerV2HandlerAdapter implements MyHandlerAdapter {    @Override    public boolean supports(Object handler) {        return handler instanceof ControllerV2;    }    @Override    public ModelView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws ServletException, IOException {        System.out.println("ControllerV2HandlerAdapter.handle");        ControllerV2 controller = (ControllerV2) handler;        MyView view = controller.process(request, response);        String viewName = extractViewName(view.getViewPath());        Map<String, Object> model = createModel(request);        ModelView modelView = new ModelView(viewName);        modelView.setModel(model);        return modelView;    }    private Map<String, Object> createModel(HttpServletRequest request) {        Map<String, Object> model = new HashMap<>();        request.getAttributeNames().asIterator().forEachRemaining(attributeName ->            model.put(attributeName, request.getAttribute(attributeName)));        return model;    }    private String extractViewName(String viewPath) {        return viewPath.replaceAll("/WEB-INF/views/([^/]+)\\.jsp", "$1");    }}