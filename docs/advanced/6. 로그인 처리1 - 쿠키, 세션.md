# 6. ë¡œê·¸ì¸ ì²˜ë¦¬1 - ì¿ í‚¤, ì„¸ì…˜<br/>## ëª©ì°¨- íŒ¨í‚¤ì§€ êµ¬ì¡° ì„¤ê³„- íšŒì› ê°€ì… ê¸°ë³¸í‹€ ê°œë°œ- ë¡œê·¸ì¸ ê¸°ëŠ¥ ê¸°ë³¸í‹€ ê°œë°œ- ë¡œê·¸ì¸ ì²˜ë¦¬í•˜ê¸° - ì¿ í‚¤ ì‚¬ìš©- ë¡œê·¸ì¸ ì²˜ë¦¬í•˜ê¸° - ì„¸ì…˜ ì§ì ‘ ë§Œë“¤ê³  ì ìš©- ë¡œê·¸ì¸ ì²˜ë¦¬í•˜ê¸° - ì„œë¸”ë¦¿ HTTP ì„¸ì…˜ - `HttpSession`, `@SessionAttribute`- ì„¸ì…˜ ì •ë³´ì™€ íƒ€ì„ ì•„ì›ƒ ì„¤ì •- ì„¸ì…˜(Session) ì •ë¦¬# ğŸ’¡íŒ¨í‚¤ì§€ êµ¬ì¡° ì„¤ê³„**package êµ¬ì¡°**- hello.login    - domain        - item        - member        - login    - web        - item        - member        - login**ë„ë©”ì¸ì´ ê°€ì¥ ì¤‘ìš”í•˜ë‹¤.**ë„ë©”ì¸: í™”ë©´, UI, ê¸°ìˆ  ì¸í”„ë¼ ë“±ë“±ì˜ ì˜ì—­ì„ ì œì™¸í•œ ì‹œìŠ¤í…œì´ êµ¬í˜„í•´ì•¼ í•˜ëŠ” í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ì—…ë¬´ ì˜ì—­ì„ ë§í•¨í–¥í›„ webì„ ë‹¤ë¥¸ ê¸°ìˆ ë¡œ ë°”ê¾¸ì–´ë„ ë„ë©”ì¸ì€ ê·¸ëŒ€ë¡œ ìœ ì§€í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. ì´ë ‡ê²Œ í•˜ë ¤ë©´ webì€ domainì„ ì•Œê³ ìˆì§€ë§Œ domainì€ webì„ ëª¨ë¥´ë„ë¡ ì„¤ê³„í•´ì•¼ í•œë‹¤. ì´ê²ƒì„ webì€ domainì„ ì˜ì¡´í•˜ì§€ë§Œ, domainì€ webì„ ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤ê³  í‘œí˜„í•œë‹¤.# ğŸ’¡íšŒì› ê°€ì… ê¸°ë³¸í‹€ ê°œë°œ<details><summary>íšŒì› ê°€ì… ê¸°ë³¸í‹€ ê°œë°œ</summary>**Member**```java@Datapublic class Member {    private Long id;        @NotEmpty    private String loginId;        @NotEmpty    private String name;        @NotEmpty    private String password;    }```**MemberRepository**```java@Slf4j@Repositorypublic class MemberRepository {    private static Map<Long, Member> store = new HashMap<>();    private static long sequence = 0L; //static ì‚¬ìš©    public Member save(Member member) {        member.setId(++sequence);        log.info("save: member={}", member);        store.put(member.getId(), member);        return member;    }    public Member findById(Long id) {        return store.get(id);    }    public Optional<Member> findByLoginId(String loginId) {        return findAll().stream()                .filter(m -> m.getLoginId().equals(loginId))                .findFirst();    }    public List<Member> findAll() {        return new ArrayList<>(store.values());    }    public void clearStore() {        store.clear();    }}```**MemberController**```java@Controller@RequiredArgsConstructor@RequestMapping("/members")public class MemberController {    private final MemberRepository memberRepository;    @GetMapping("/add")    public String addForm(@ModelAttribute("member") Member member) {        return "members/addMemberForm";    }    @PostMapping("/add")    public String save(@Valid @ModelAttribute Member member, BindingResult bindingResult) {        if (bindingResult.hasErrors()) {            return "members/addMemberForm";        }        memberRepository.save(member);        return "redirect:/";    }}````templates/members/addMemberForm.html````html<!DOCTYPE HTML><html xmlns:th="http://www.thymeleaf.org"><head>  <meta charset="utf-8">  <link th:href="@{/css/bootstrap.min.css}"        href="../css/bootstrap.min.css" rel="stylesheet">  <style>    .container {      max-width: 560px;    }    .field-error {      border-color: #dc3545;      color: #dc3545;    }  </style></head><body><div class="container">  <div class="py-5 text-center">    <h2>íšŒì› ê°€ì…</h2>  </div>  <h4 class="mb-3">íšŒì› ì •ë³´ ì…ë ¥</h4>  <form action="" th:action th:object="${member}" method="post">    <div th:if="${#fields.hasGlobalErrors()}">      <p class="field-error" th:each="err : ${#fields.globalErrors()}" th:text="${err}">ì „ì²´ ì˜¤ë¥˜ ë©”ì‹œì§€</p>    </div>    <div>      <label for="loginId">ë¡œê·¸ì¸ ID</label>      <input type="text" id="loginId" th:field="*{loginId}" class="form-control"             th:errorclass="field-error">      <div class="field-error" th:errors="*{loginId}" />    </div>    <div>      <label for="password">ë¹„ë°€ë²ˆí˜¸</label>      <input type="password" id="password" th:field="*{password}"             class="form-control"             th:errorclass="field-error">      <div class="field-error" th:errors="*{password}" />    </div>    <div>      <label for="name">ì´ë¦„</label>      <input type="text" id="name" th:field="*{name}" class="form-control"             th:errorclass="field-error">      <div class="field-error" th:errors="*{name}" />    </div>    <hr class="my-4">    <div class="row">      <div class="col">        <button class="w-100 btn btn-primary btn-lg" type="submit">íšŒì›          ê°€ì…</button>      </div>      <div class="col">        <button class="w-100 btn btn-secondary btn-lg"                onclick="location.href='items.html'"                th:onclick="|location.href='@{/}'|"                type="button">ì·¨ì†Œ</button>      </div>    </div>  </form></div> <!-- /container --></body></html>```</details># ğŸ’¡ë¡œê·¸ì¸ ê¸°ëŠ¥ ê¸°ë³¸í‹€ ê°œë°œ<details><summary>ë¡œê·¸ì¸ ê¸°ëŠ¥ ê¸°ë³¸í‹€ ê°œë°œ</summary>**LoginService**```java@Service@RequiredArgsConstructorpublic class LoginService {        private final MemberRepository memberRepository;        public Member login(String loginId, String password) {        return memberRepository.findByLoginId(loginId)                .filter(m -> m.getPassword().equals(password))                .orElse(null);    }    }```**LoginForm**```java@Datapublic class LoginForm {    @NotEmpty    private String loginId;    @NotEmpty    private String password;}```**LoginController**```java@Slf4j@Controller@RequiredArgsConstructorpublic class LoginController {    private final LoginService loginService;    @GetMapping("/login")    public String loginForm(@Validated @ModelAttribute LoginForm form) {        return "/login/loginForm";    }    @PostMapping("/login")    public String login(@Validated @ModelAttribute LoginForm form, BindingResult bindingResult) {        if (bindingResult.hasErrors()) {            return "/login/loginForm";        }        Member loginMember = loginService.login(form.getLoginId(), form.getPassword());        log.info("login? {}", loginMember);        if (loginMember == null) {            bindingResult.reject("loginFail", "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.");            return "login/loginForm";        }        return "redirect:/";    }}```- ë¡œê·¸ì¸ì— ì‹¤íŒ¨í•˜ë©´ `bindingResult.reject()` ë¥¼ ì‚¬ìš©í•´ì„œ ê¸€ë¡œë²Œ ì˜¤ë¥˜(`ObjectError`)ë¥¼ ìƒì„±í•œë‹¤.`templates/login/loginForm.html````html<!DOCTYPE HTML><html xmlns:th="http://www.thymeleaf.org"><head>    <meta charset="utf-8">    <link th:href="@{/css/bootstrap.min.css}"          href="../css/bootstrap.min.css" rel="stylesheet">    <style>        .container {            max-width: 560px;        }        .field-error {            border-color: #dc3545;            color: #dc3545;        }    </style></head><body><div class="container">    <div class="py-5 text-center">        <h2>ë¡œê·¸ì¸</h2>    </div>    <form action="item.html" th:action th:object="${loginForm}" method="post">        <div th:if="${#fields.hasGlobalErrors()}">            <p class="field-error" th:each="err : ${#fields.globalErrors()}"               th:text="${err}">ì „ì²´ ì˜¤ë¥˜ ë©”ì‹œì§€</p>        </div>        <div>            <label for="loginId">ë¡œê·¸ì¸ ID</label>            <input type="text" id="loginId" th:field="*{loginId}" class="formcontrol"                   th:errorclass="field-error">            <div class="field-error" th:errors="*{loginId}" />        </div>        <div>            <label for="password">ë¹„ë°€ë²ˆí˜¸</label>            <input type="password" id="password" th:field="*{password}"                   class="form-control"                   th:errorclass="field-error">            <div class="field-error" th:errors="*{password}" />        </div>        <hr class="my-4">        <div class="row">            <div class="col">                <button class="w-100 btn btn-primary btn-lg" type="submit">                    ë¡œê·¸ì¸</button>            </div>            <div class="col">                <button class="w-100 btn btn-secondary btn-lg"                        onclick="location.href='items.html'"                        th:onclick="|location.href='@{/}'|"                        type="button">ì·¨ì†Œ</button>            </div>        </div>    </form></div> <!-- /container --></body></html>```**ê²°ê³¼ - ë¡œê·¸ì¸ ì‹¤íŒ¨**![image](https://user-images.githubusercontent.com/83503188/210168007-b8c9d02e-e7eb-4428-8939-0e8b72830814.png)</details><br/><br/><br/># ğŸ’¡ë¡œê·¸ì¸ ì²˜ë¦¬í•˜ê¸° - ì¿ í‚¤ ì‚¬ìš©## ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€í•˜ê¸°**ì¿ í‚¤**ì„œë²„ì—ì„œ ë¡œê·¸ì¸ì— ì„±ê³µí•˜ë©´ HTTP ì‘ë‹µì— ì¿ í‚¤ë¥¼ ë‹´ì•„ì„œ ë¸Œë¼ìš°ì €ì— ì „ë‹¬í•˜ì. ê·¸ëŸ¬ë©´ ë¸Œë¼ìš°ì €ëŠ” ì•ìœ¼ë¡œ í•´ë‹¹ ì¿ í‚¤ë¥¼ ì§€ì†í•´ì„œ ë³´ë‚´ì¤€ë‹¤.**ì¿ í‚¤ ìƒì„±**![image](https://user-images.githubusercontent.com/83503188/210168079-cb96b631-b900-4550-ab5b-e2ae60d157ea.png)**í´ë¼ì´ì–¸íŠ¸ ì¿ í‚¤ ì „ë‹¬1**![image](https://user-images.githubusercontent.com/83503188/210168092-96a20545-d246-4275-8606-0714392a457d.png)**í´ë¼ì´ì–¸íŠ¸ ì¿ í‚¤ ì „ë‹¬2**![image](https://user-images.githubusercontent.com/83503188/210168101-044dbb0d-6482-4498-a30c-3c42d888bb2e.png)### **â­ï¸ì¿ í‚¤ì—ëŠ” ì˜ì† ì¿ í‚¤ì™€ ì„¸ì…˜ ì¿ í‚¤ê°€ ìˆë‹¤.**- ì˜ì† ì¿ í‚¤: ë§Œë£Œ ë‚ ì§œë¥¼ ì…ë ¥í•˜ë©´ í•´ë‹¹ ë‚ ì§œê¹Œì§€ ìœ ì§€- ì„¸ì…˜ ì¿ í‚¤: ë§Œë£Œ ë‚ ì§œë¥¼ ìƒëµí•˜ë©´ ë¸Œë¼ìš°ì € ì¢…ë£Œì‹œ ê¹Œì§€ë§Œ ìœ ì§€ë¸Œë¼ìš°ì € ì¢…ë£Œì‹œ ë¡œê·¸ì•„ì›ƒì´ ë˜ê¸¸ ê¸°ëŒ€í•˜ë¯€ë¡œ, ìš°ë¦¬ì—ê²Œ í•„ìš”í•œ ê²ƒì€ `ì„¸ì…˜ ì¿ í‚¤`ì´ë‹¤.<br/><br/>**LoginController - login()**```java@PostMapping("/login")public String login(@Validated @ModelAttribute LoginForm form, BindingResult bindingResult, HttpServletResponse response) {    if (bindingResult.hasErrors()) {        return "/login/loginForm";    }    Member loginMember = loginService.login(form.getLoginId(), form.getPassword());    log.info("login? {}", loginMember);    if (loginMember == null) {        bindingResult.reject("loginFail", "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.");        return "login/loginForm";    }    // ì¿ í‚¤ì— ì‹œê°„ ì •ë³´ë¥¼ ì£¼ì§€ ì•Šìœ¼ë©´ ì„¸ì…˜ ì¿ í‚¤ -> ë¸Œë¼ìš°ì € ì¢…ë£Œì‹œ ëª¨ë‘ ì¢…ë£Œ    Cookie idCookie = new Cookie("memberId", String.valueOf(loginMember.getId()));    response.addCookie(idCookie);    return "redirect:/";}```**ê²°ê³¼**![image](https://user-images.githubusercontent.com/83503188/210168185-c5d83beb-8c92-4c6a-8f3a-a8bcfa0bb919.png)**í™ˆ - ë¡œê·¸ì¸ ì²˜ë¦¬**```java@Slf4j@Controller@RequiredArgsConstructorpublic class HomeController {  private final MemberRepository memberRepository;  @GetMapping("/")  public String loginHome(@CookieValue(name = "memberId", required = false) Long memberId, Model model) {    if (memberId == null) {      return "home";    }    // ë¡œê·¸ì¸ëœ ë©¤ë²„    Member loginMember = memberRepository.findById(memberId);    if (loginMember ==  null) {      return "home";    }    model.addAttribute("member", loginMember);    return "loginHome";  }}```- ì¿ í‚¤ ê°’ì€ `String` íƒ€ì…ì¸ë° `Long` íƒ€ì…ìœ¼ë¡œ ë°›ì„ ìˆ˜ ìˆëŠ” ì´ìœ ëŠ” ìŠ¤í”„ë§ì´ ìë™ìœ¼ë¡œ íƒ€ì… ì»¨ë²„íŒ…ì„ í•´ì¤€ë‹¤.- `@CookieValue` ë¥¼ ì‚¬ìš©í•˜ë©´ í¸ë¦¬í•˜ê²Œ ì¿ í‚¤ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.- ë¡œê·¸ì¸ í•˜ì§€ ì•Šì€ ì‚¬ìš©ìë„ í™ˆì— ì ‘ê·¼í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— `required = false` ë¥¼ ì‚¬ìš©í•œë‹¤.<details><summary>templates/loginHome.html</summary>`templates/loginHome.html````html<!DOCTYPE HTML><html xmlns:th="http://www.thymeleaf.org"><head>    <meta charset="utf-8">    <link th:href="@{/css/bootstrap.min.css}"          href="../css/bootstrap.min.css" rel="stylesheet"></head><body><div class="container" style="max-width: 600px">    <div class="py-5 text-center">        <h2>í™ˆ í™”ë©´</h2>    </div>    <h4 class="mb-3" th:text="|ë¡œê·¸ì¸: ${member.name}|">ë¡œê·¸ì¸ ì‚¬ìš©ì ì´ë¦„</h4>    <hr class="my-4">    <div class="row">        <div class="col">            <button class="w-100 btn btn-secondary btn-lg" type="button"                    th:onclick="|location.href='@{/items}'|">                ìƒí’ˆ ê´€ë¦¬            </button>        </div>        <div class="col">            <form th:action="@{/logout}" method="post">                <button class="w-100 btn btn-dark btn-lg" type="submit">                    ë¡œê·¸ì•„ì›ƒ                </button>            </form>        </div>    </div>    <hr class="my-4"></div> <!-- /container --></body></html> ```**ê²°ê³¼**</details>![image](https://user-images.githubusercontent.com/83503188/210168334-14a31d94-35bb-4da5-bef6-4dde199f769f.png)<br/><br/>## âš¡ï¸ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥ë¡œê·¸ì•„ì›ƒ ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.- ì„¸ì…˜ ì¿ í‚¤ì´ë¯€ë¡œ ì›¹ ë¸Œë¼ìš°ì € ì¢…ë£Œì‹œ- ì„œë²„ì—ì„œ í•´ë‹¹ ì¿ í‚¤ì˜ ì¢…ë£Œ ë‚ ì§œë¥¼ 0ìœ¼ë¡œ ì§€ì •**LoginController - logout ê¸°ëŠ¥ ì¶”ê°€**```java@PostMapping("/logout")public String logout(HttpServletResponse response) {    expireCookie(response, "memberId");    return "redirect:/";}private void expireCookie(HttpServletResponse response, String cookieName) {    Cookie cookie = new Cookie(cookieName, null);    cookie.setMaxAge(0);    response.addCookie(cookie);}```**ê²°ê³¼**![image](https://user-images.githubusercontent.com/83503188/210168468-00df7f71-aa29-4c32-818c-fd5808343d11.png)- ë¡œê·¸ì•„ì›ƒë„ ì‘ë‹µ ì¿ í‚¤ë¥¼ ìƒì„±í•˜ëŠ”ë° `Max-Age=0` ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. í•´ë‹¹ ì¿ í‚¤ëŠ” ì¦‰ì‹œ ì¢…ë£Œëœë‹¤.<br/><br/>### â­ï¸ì‚¬ìš©ìê°€ ë³´ë‚¸ ì¿ í‚¤ ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ìƒˆë¡œ ìƒì„±í•´ì„œ ë³´ë‚´ëŠ” ì´ìœ ê°€ ìˆì„ê¹Œìš”?ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ì— ì €ì¥ëœ ì¿ í‚¤ë¥¼ ë§Œë£Œì‹œì¼œì•¼ í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.ì‚¬ìš©ìê°€ ì„œë²„ë¡œ ë³´ë‚¸ ì¿ í‚¤ëŠ” ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ì— ì €ì¥ëœ ì¿ í‚¤ì˜ ë³µì‚¬ë³¸ì…ë‹ˆë‹¤.ë”°ë¼ì„œ ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ì— ì €ì¥ëœ ì¿ í‚¤(member id)ë¥¼ ë§Œë£Œì‹œí‚¤ë ¤ë©´ ì„œë²„ì—ì„œ ë™ì¼í•œ ì´ë¦„(member id)ìœ¼ë¡œ ì¿ í‚¤ë¥¼ ë§Œë“¤ì–´ì„œ ë¸Œë¼ìš°ì €ì— ì €ì¥ëœ ì¿ í‚¤ë¥¼ ìƒˆë¡œìš´ ì¿ í‚¤ë¡œ ë®ì–´ì“°ê²Œ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.**ì„œë²„ì—ì„œ ìƒˆë¡­ê²Œ ì¿ í‚¤ë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©ìì—ê²Œ ì „ë‹¬í•˜ëŠ” ë°©ë²• ì™¸ì— ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ì— ì €ì¥ëœ ì¿ í‚¤ë¥¼ ì œì–´í•˜ëŠ” ë°©ë²•ì€ ì—†ìŠµë‹ˆë‹¤.**### â­ï¸logout() ì—ì„œ ì„¸ì…˜ ì¿ í‚¤ëŠ” ì–´ì°¨í”¼ ìš”ì²­ì‹œ ê°’ì´ ì „ë‹¬ì´ ë˜ì–´ GET ìœ¼ë¡œ ë§¤í•‘í•´ë„ ë ê²ƒê°™ì€ë° POST ë¡œ ë§¤í•‘í•œ ì´ìœ ê°€ ê¶ê¸ˆí•©ë‹ˆë‹¤.1. ì›ë˜ get ìš”ì²­ì˜ ì˜ë„ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°íšŒí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒì´ ì•„ë‹™ë‹ˆë‹¤.   ë¡œê·¸ì•„ì›ƒì€ ì„œë²„ ë‚´ ì„¸ì…˜ì˜ ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒì´ë¯€ë¡œ getìœ¼ë¡œ ë¡œê·¸ì•„ì›ƒì„ ìš”ì²­í•  ìˆ˜ ìˆëŠ” ê²ƒê³¼ ë³„ê°œë¡œ ì˜ë¯¸ìƒ post ìš”ì²­ì´ ë” ì ì ˆí•©ë‹ˆë‹¤.2. ë¸Œë¼ìš°ì €ê°€ ë”ìš± ì¾Œì í•œ ì‚¬ìš©ì ê²½í—˜ì„ ìœ„í•´ prefetchingì„ ì‹œë„í•©ë‹ˆë‹¤. prefetchingì€ ë¯¸ë¦¬ ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒ ì •ë„ë¡œ ìƒê°í•˜ì‹œë©´ ë©ë‹ˆë‹¤. ì´ ê³¼ì •ì—ì„œ get ìš”ì²­ì´ ë°œìƒë˜ëŠ”ë° ì‚¬ìš©ìì˜ ì˜ë„ì™€ ë³„ê°œë¡œ get /logoutì´ í˜¸ì¶œë˜ì–´ ë¡œê·¸ì•„ì›ƒëœ ìƒíƒœë¡œ ë³€ê²½ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.ì°¸ê³ : https://www.baeldung.com/logout-get-vs-post<br/><br/><br/># ğŸ’¡ì¿ í‚¤ì™€ ë³´ì•ˆ ë¬¸ì œì¿ í‚¤ë¥¼ ì‚¬ìš©í•´ì„œ ë¡œê·¸ì¸Idë¥¼ ì „ë‹¬í•´ì„œ ë¡œê·¸ì¸ì„ ìœ ì§€í•  ìˆ˜ ìˆì—ˆë‹¤. ê·¸ëŸ°ë° ì—¬ê¸°ì—ëŠ” ì‹¬ê°í•œ ë³´ì•ˆ ë¬¸ì œê°€ ìˆë‹¤.**ë³´ì•ˆ ë¬¸ì œ**- **ì¿ í‚¤ ê°’ì€ ì„ì˜ë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.**    - í´ë¼ì´ì–¸íŠ¸ê°€ ì¿ í‚¤ë¥¼ ê°•ì œë¡œ ë³€ê²½í•˜ë©´ ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ëœë‹¤.    - `Cookie: memberId=1` -> `Cookie: memberId=2`, í´ë¼ì´ì–¸íŠ¸ê°€ ì¿ í‚¤ì˜ ê°’ì„ ë³€ê²½í•˜ë©´ ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ì´ë¦„ì´ ë³´ì´ê²Œëœë‹¤.- **ì¿ í‚¤ì— ë³´ê´€ëœ ì •ë³´ëŠ” í›”ì³ê°ˆ ìˆ˜ ìˆë‹¤.**    - ë§Œì•½ ì¿ í‚¤ì— ê°œì¸ì •ë³´ë‚˜ ì‹ ìš©ì¹´ë“œ ì •ë³´ê°€ ìˆë‹¤ë©´?    - ì´ ì •ë³´ê°€ ì›¹ ë¸Œë¼ìš°ì €ì—ë„ ë³´ê´€ë˜ê³ , ë„¤íŠ¸ì›Œí¬ ìš”ì²­ë§ˆë‹¤ ê³„ì† í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ì „ë‹¬ëœë‹¤.    - ì¿ í‚¤ì˜ ì •ë³´ê°€ ë‚˜ì˜ ë¡œì»¬ PCì—ì„œ í„¸ë¦´ ìˆ˜ë„ ìˆê³ , ë„¤íŠ¸ì›Œí¬ ì „ì†¡ êµ¬ê°„ì—ì„œ í„¸ë¦´ ìˆ˜ë„ ìˆë‹¤.- **í•´ì»¤ê°€ ì¿ í‚¤ë¥¼ í•œë²ˆ í›”ì³ê°€ë©´ í‰ìƒ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.**    - í•´ì»¤ê°€ ì¿ í‚¤ë¥¼ í›”ì³ê°€ì„œ ê·¸ ì¿ í‚¤ë¡œ ì•…ì˜ì ì¸ ìš”ì²­ì„ ê³„ì† ì‹œë„í•  ìˆ˜ ìˆë‹¤.**ëŒ€ì•ˆ**- ì¿ í‚¤ì— ì¤‘ìš”í•œ ê°’ì„ ë…¸ì¶œí•˜ì§€ ì•Šê³ , ì‚¬ìš©ì ë³„ë¡œ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•œ ì„ì˜ì˜ í† í°(ëœë¤ ê°’)ì„ ë…¸ì¶œí•˜ê³ , ì„œë²„ì—ì„œ í† í°ê³¼ ì‚¬ìš©ì idë¥¼ ë§¤í•‘í•´ì„œ ì¸ì‹í•œë‹¤. ê·¸ë¦¬ê³  ì„œë²„ì—ì„œ í† í°ì„ ê´€ë¦¬í•œë‹¤.- í† í°ì€ í•´ì»¤ê°€ ì„ì˜ì˜ ê°’ì„ ë„£ì–´ë„ ì°¾ì„ ìˆ˜ ì—†ë„ë¡ ì˜ˆìƒ ë¶ˆê°€ëŠ¥ í•´ì•¼ í•œë‹¤.- í•´ì»¤ê°€ í† í°ì„ í„¸ì–´ê°€ë„ ì‹œê°„ì´ ì§€ë‚˜ë©´ ì‚¬ìš©í•  ìˆ˜ ì—†ë„ë¡ ì„œë²„ì—ì„œ í•´ë‹¹ í† í°ì˜ ë§Œë£Œì‹œê°„ì„ ì§§ê²Œ(ì˜ˆ: 30ë¶„)ìœ ì§€í•œë‹¤. ë˜ëŠ” í•´í‚¹ì´ ì˜ì‹¬ë˜ëŠ” ê²½ìš° ì„œë²„ì—ì„œ í•´ë‹¹ í† í°ì„ ê°•ì œë¡œ ì œê±°í•˜ë©´ ëœë‹¤.### â­ï¸íƒ€ ë„ë©”ì¸ ì¿ í‚¤ ì ‘ê·¼ì— ê´€í•˜ì—¬1. **ì¿ í‚¤ë¥¼ ì„¤ì •í•  ë•Œ í•˜ìœ„ ë„ë©”ì¸ì€ ê°™ì´ ì¿ í‚¤ê°€ ê³µìœ  ëœë‹¤.**2. **íƒ€ ë„ë©”ì¸ ì¿ í‚¤ì— ê´€í•˜ì—¬.**íƒ€ ë„ë©”ì¸ì— ëŒ€í•œ ì¿ í‚¤ëŠ” ì ‘ê·¼ì´ ë¶ˆê°€í•©ë‹ˆë‹¤.3. **SameSite ì— ê´€í•˜ì—¬.**ìš°ì„  í¼ìŠ¤íŠ¸ íŒŒí‹° ì¿ í‚¤ì™€ ì„œë“œ íŒŒí‹° ì¿ í‚¤ë¼ëŠ” ê°œë…ì„ ì•Œ í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ë“¤ì–´ example.com ì‚¬ì´íŠ¸ì—ì„œ product.com ì˜ ëŒ€í‘œìƒí’ˆ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ” ê²½ìš°ë¥¼ ìƒê°í•˜ê² ìŠµë‹ˆë‹¤.í´ë¼ì´ì–¸íŠ¸ê°€ example.com ì‚¬ì´íŠ¸ì— ì ‘ì†í•©ë‹ˆë‹¤. example.comì˜ ëŒ€ë¶€ë¶„ì˜ ë¦¬ì†ŒìŠ¤(CSS, JSíŒŒì¼ ë“±)ì€ example.comì—ì„œ ì œê³µí•˜ì§€ë§Œ, ìƒí’ˆ ì´ë¯¸ì§€ëŠ” example.comì´ ì•„ë‹Œ product.comì´ë¼ëŠ” ì™¸ë¶€ì—ì„œ í˜¸ì¶œí•˜ê³  ìˆìŠµë‹ˆë‹¤.ì´ ë•Œ í´ë¼ì´ì–¸íŠ¸ëŠ” example.com ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ìš”ì²­í• ë–„ëŠ” example.comì˜ ì¿ í‚¤ë¥¼, product.comì˜ ì´ë¯¸ì§€ë¥¼ ìš”ì²­í• ë•ŒëŠ” product.comì˜ ì¿ í‚¤ë¥¼ ì „ë‹¬í•˜ê²Œ ë©ë‹ˆë‹¤. í´ë¼ì´ì–¸íŠ¸ëŠ” example.com ì‚¬ì´íŠ¸ì— ì ‘ì†í•œê²ƒì´ê¸°ì— example.comì˜ ì¿ í‚¤ëŠ” 'í¼ìŠ¤íŠ¸ íŒŒí‹° ì¿ í‚¤', product.comì˜ ì¿ í‚¤ëŠ” 'ì„œë“œ íŒŒí‹° ì¿ í‚¤'ë¼ê³  êµ¬ë¶„ í•©ë‹ˆë‹¤.SameSiteëŠ” ì´ ì¤‘ ì„œë“œ íŒŒí‹° ì¿ í‚¤ì— ëŒ€í•œ ì •ì±…ì…ë‹ˆë‹¤. ì´ ê°’ì€ ê¸°ë³¸ì ìœ¼ë¡œ Noneì…ë‹ˆë‹¤. Noneì€ 'ì„œë“œ íŒŒí‹° ì¿ í‚¤ë¥¼ í•­ìƒ ë³´ë‚¸ë‹¤'ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŸ¬í•œ ì •ì±…ì´ CSRF ê°™ì€ í•´í‚¹ ê³µê²©ì— ì·¨ì•½í•˜ë‹¤ëŠ” ë¬¸ì œê°€ ìˆê¸°ì— ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ í¬ë¡¬ ê°™ì€ ë¸Œë¼ìš°ì €ëŠ” SameSite ê¸°ë³¸ ê°’ì´ Lax (ì˜ˆì™¸ìƒí™©ì„ ì œì™¸í•˜ê³  ì„œë“œ íŒŒí‹° ì¿ í‚¤ë¥¼ ì „ì†¡í•˜ì§€ ì•ŠìŒ) ìœ¼ë¡œ ë³€ê²½í•˜ê¸°ë„ í•˜ì˜€ìŠµë‹ˆë‹¤.**SameSiteëŠ” ì´ì²˜ëŸ¼ ì„œë“œ íŒŒí‹° ì¿ í‚¤ì— ëŒ€í•œ ì •ì±…ì´ë©° ì´ë¥¼ ì„¤ì •í•œë‹¤ê³  í•´ë„ íƒ€ ë„ë©”ì¸ì˜ ì¿ í‚¤ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.**<br/><br/><br/># ğŸ’¡ë¡œê·¸ì¸ ì²˜ë¦¬í•˜ê¸° - ì„¸ì…˜ ë™ì‘ ë°©ì‹ - UUID, Server Session ì €ì¥ì†Œì•ì„œ ì¿ í‚¤ì— ì¤‘ìš”í•œ ì •ë³´ë¥¼ ë³´ê´€í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ê°€ì§€ ë³´ì•ˆ ì´ìŠˆê°€ ìˆì—ˆë‹¤. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ë ¤ë©´ ê²°êµ­ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ëª¨ë‘ ì„œë²„ì— ì €ì¥í•´ì•¼ í•œë‹¤.ê·¸ë¦¬ê³  í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” ì¶”ì • ë¶ˆê°€ëŠ¥í•œ ì„ì˜ì˜ ì‹ë³„ì ê°’ìœ¼ë¡œ ì—°ê²°í•´ì•¼ í•œë‹¤.> **`Session`: ì„œë²„ì— ì¤‘ìš”í•œ ì •ë³´ë¥¼ ë³´ê´€í•˜ê³  ì—°ê²°ì„ ìœ ì§€í•˜ëŠ” ë°©ë²•**## âš¡ï¸ì„¸ì…˜ ë™ì‘ ë°©ì‹**ë¡œê·¸ì¸**![image](https://user-images.githubusercontent.com/83503188/210169675-f587e62e-239a-4ab0-948b-972ddf963199.png)- ì‚¬ìš©ìê°€ loginId , password ì •ë³´ë¥¼ ì „ë‹¬í•˜ë©´ ì„œë²„ì—ì„œ í•´ë‹¹ ì‚¬ìš©ìê°€ ë§ëŠ”ì§€ í™•ì¸í•œë‹¤.**ì„¸ì…˜ ìƒì„±**![image](https://user-images.githubusercontent.com/83503188/210169697-f80f9cca-0f88-44fd-8a2a-b7a6f9e389fe.png)- ì„¸ì…˜ IDë¥¼ ìƒì„±í•˜ëŠ”ë°, ì¶”ì • ë¶ˆê°€ëŠ¥í•´ì•¼ í•œë‹¤.- `UUID` ëŠ” ì¶”ì •ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤.    - `Cookie: mySessionId=zz0101xx-bab9-4b92-9b32-dadb280f4b61`- ìƒì„±ëœ ì„¸ì…˜ IDì™€ ì„¸ì…˜ì— ë³´ê´€í•  ê°’( `memberA` )ì„ ì„œë²„ì˜ ì„¸ì…˜ ì €ì¥ì†Œì— ë³´ê´€í•œë‹¤.**ì„¸ì…˜idë¥¼ ì‘ë‹µ ì¿ í‚¤ë¡œ ì „ë‹¬**![image](https://user-images.githubusercontent.com/83503188/210169717-a405bb8d-9af8-48dc-8972-1987a886bcf9.png)**í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” ê²°êµ­ ì¿ í‚¤ë¡œ ì—°ê²°ì´ ë˜ì–´ì•¼ í•œë‹¤.**- ì„œë²„ëŠ” í´ë¼ì´ì–¸íŠ¸ì— `mySessionId` ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì„¸ì…˜ID ë§Œ ì¿ í‚¤ì— ë‹´ì•„ì„œ ì „ë‹¬í•œë‹¤.- í´ë¼ì´ì–¸íŠ¸ëŠ” ì¿ í‚¤ ì €ì¥ì†Œì— `mySessionId` ì¿ í‚¤ë¥¼ ë³´ê´€í•œë‹¤.**ì¤‘ìš”**- ì—¬ê¸°ì„œ ì¤‘ìš”í•œ í¬ì¸íŠ¸ëŠ” íšŒì›ê³¼ ê´€ë ¨ëœ ì •ë³´ëŠ” ì „í˜€ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì´ë‹¤.- ì˜¤ì§ ì¶”ì • ë¶ˆê°€ëŠ¥í•œ ì„¸ì…˜ IDë§Œ ì¿ í‚¤ë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬í•œë‹¤.**í´ë¼ì´ì–¸íŠ¸ì˜ ì„¸ì…˜id ì¿ í‚¤ ì „ë‹¬**![image](https://user-images.githubusercontent.com/83503188/210169751-a9a6f2a5-beac-42eb-8449-3a91563fe9b8.png)- í´ë¼ì´ì–¸íŠ¸ëŠ” ìš”ì²­ì‹œ í•­ìƒ `mySessionId` ì¿ í‚¤ë¥¼ ì „ë‹¬í•œë‹¤.- ì„œë²„ì—ì„œëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ì „ë‹¬í•œ `mySessionId` ì¿ í‚¤ ì •ë³´ë¡œ ì„¸ì…˜ ì €ì¥ì†Œë¥¼ ì¡°íšŒí•´ì„œ ë¡œê·¸ì¸ì‹œ ë³´ê´€í•œ ì„¸ì…˜ ì •ë³´ë¥¼ ì‚¬ìš©í•œë‹¤.<br/>## **âš¡ï¸ì •ë¦¬**ì„¸ì…˜ì„ ì‚¬ìš©í•´ì„œ ì„œë²„ì—ì„œ ì¤‘ìš”í•œ ì •ë³´ë¥¼ ê´€ë¦¬í•˜ê²Œ ë˜ì—ˆë‹¤. ë•ë¶„ì— ë‹¤ìŒê³¼ ê°™ì€ ë³´ì•ˆ ë¬¸ì œë“¤ì„ í•´ê²°í•  ìˆ˜ ìˆë‹¤.- **ì¿ í‚¤ ê°’ì„ ë³€ì¡° ê°€ëŠ¥**   - -> ì˜ˆìƒ ë¶ˆê°€ëŠ¥í•œ ë³µì¡í•œ ì„¸ì…˜Idë¥¼ ì‚¬ìš©í•œë‹¤.- **ì¿ í‚¤ì— ë³´ê´€í•˜ëŠ” ì •ë³´ëŠ” í´ë¼ì´ì–¸íŠ¸ í•´í‚¹ì‹œ í„¸ë¦´ ê°€ëŠ¥ì„±ì´ ìˆë‹¤.**   - -> ì„¸ì…˜Idê°€ í„¸ë ¤ë„ ì—¬ê¸°ì—ëŠ” ì¤‘ìš”í•œ ì •ë³´ê°€ ì—†ë‹¤.- **ì¿ í‚¤ íƒˆì·¨ í›„**   - -> ì‚¬ìš© í•´ì»¤ê°€ í† í°ì„ í„¸ì–´ê°€ë„ ì‹œê°„ì´ ì§€ë‚˜ë©´ ì‚¬ìš©í•  ìˆ˜ ì—†ë„ë¡ ì„œë²„ì—ì„œ ì„¸ì…˜ì˜ ë§Œë£Œì‹œê°„ì„ ì§§ê²Œ(ì˜ˆ: 30ë¶„) ìœ ì§€í•œë‹¤. ë˜ëŠ” í•´í‚¹ì´ ì˜ì‹¬ë˜ëŠ” ê²½ìš° ì„œë²„ì—ì„œ í•´ë‹¹ ì„¸ì…˜ì„ ê°•ì œë¡œ ì œê±°í•˜ë©´ ëœë‹¤.<br/><br/>### â­ï¸ì„¸ì…˜ IDê°€ íƒ€ì„ì•„ì›ƒìœ¼ë¡œ ì„¤ì •í•œ 30ë¶„ì´ ì§€ë‚˜ì§€ ì•Šì•˜ë‹¤ë©´ ìœ„í—˜í•˜ì§€ ì•Šë‚˜ìš”?í•´ì»¤ì—ê²Œ ì´ë¯¸ íƒˆì·¨ë‹¹í–ˆë‹¤ë©´ ë§Œë£Œë˜ê¸°ë¥¼ ê¸°ë‹¤ë¦´ ìˆ˜ ë°–ì—” ì—†ìŠµë‹ˆë‹¤.íƒˆì·¨ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ httpOnly, secure cookie ë¥¼ ì ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.<br/><br/><br/># ğŸ’¡ë¡œê·¸ì¸ ì²˜ë¦¬í•˜ê¸° - ì„¸ì…˜ ì§ì ‘ ë§Œë“¤ê³  ì ìš©ì„¸ì…˜ ê´€ë¦¬ëŠ” í¬ê²Œ ë‹¤ìŒ 3ê°€ì§€ ê¸°ëŠ¥ì„ ì œê³µí•˜ë©´ ëœë‹¤.- **ì„¸ì…˜ ìƒì„±**    - sessionId ìƒì„± (ì„ì˜ì˜ ì¶”ì • ë¶ˆê°€ëŠ¥í•œ ëœë¤ ê°’)    - ì„¸ì…˜ ì €ì¥ì†Œì— sessionIdì™€ ë³´ê´€í•  ê°’ ì €ì¥    - sessionIdë¡œ ì‘ë‹µ ì¿ í‚¤ë¥¼ ìƒì„±í•´ì„œ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬- **ì„¸ì…˜ ì¡°íšŒ**    - í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•œ sessionId ì¿ í‚¤ì˜ ê°’ìœ¼ë¡œ, ì„¸ì…˜ ì €ì¥ì†Œì— ë³´ê´€í•œ ê°’ ì¡°íšŒ- **ì„¸ì…˜ ë§Œë£Œ**    - í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•œ sessionId ì¿ í‚¤ì˜ ê°’ìœ¼ë¡œ, ì„¸ì…˜ ì €ì¥ì†Œì— ë³´ê´€í•œ sessionIdì™€ ê°’ ì œê±°**SessionManager - ì„¸ì…˜ ê´€ë¦¬**```java@Componentpublic class SessionManager {    public static final String SESSION_COOKIE_NAME = "mySessionId";    private Map<String, Object> sessionStore = new ConcurrentHashMap<>();    /**     * ì„¸ì…˜ ìƒì„±     */    public void createSession(Object value, HttpServletResponse response) {        String sessionId = UUID.randomUUID().toString();        sessionStore.put(sessionId, value);        // ì¿ í‚¤ ìƒì„±        Cookie mySessionCookie = new Cookie(SESSION_COOKIE_NAME, sessionId);        response.addCookie(mySessionCookie);    }    /**     * ì„¸ì…˜ ì¡°íšŒ     */    public Object getSession(HttpServletRequest request) {        Cookie sessionCookie = findCookie(request, SESSION_COOKIE_NAME);        if (sessionCookie == null) {            return null;        }        return sessionStore.get(sessionCookie.getValue());    }    /**     * ì„¸ì…˜ ë§Œë£Œ     */    public void expire(HttpServletRequest request) {        Cookie sessionCookie = findCookie(request, SESSION_COOKIE_NAME);        if (sessionCookie != null) {            sessionStore.remove(sessionCookie.getValue());        }    }    private Cookie findCookie(HttpServletRequest request, String cookieName) {        if (request.getCookies() == null) {            return null;        }        return Arrays.stream(request.getCookies())                .filter(cookie -> cookie.getName().equals(cookieName))                .findAny()                .orElse(null);    }}```<br/><br/>## âš¡ï¸ì§ì ‘ ë§Œë“  ì„¸ì…˜ ì ìš©**LoginController - loginV2()**```java@PostMapping("/login")public String loginV2(@Validated @ModelAttribute LoginForm form, BindingResult bindingResult, HttpServletResponse response) {    if (bindingResult.hasErrors()) {        return "/login/loginForm";    }    Member loginMember = loginService.login(form.getLoginId(), form.getPassword());    log.info("login? {}", loginMember);    if (loginMember == null) {        bindingResult.reject("loginFail", "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.");        return "login/loginForm";    }    //ì„¸ì…˜ ê´€ë¦¬ìë¥¼ í†µí•´ ì„¸ì…˜ì„ ìƒì„±í•˜ê³ , íšŒì› ë°ì´í„° ë³´ê´€    sessionManager.createSession(loginMember, response);    return "redirect:/";}```**LoginController - logoutV2()**```java@PostMapping("/logout")public String logoutV2(HttpServletRequest request) {    sessionManager.expire(request);    return "redirect:/";}```**HomeController - homeLoginV2()**```java    @GetMapping("/")    public String loginHomeV2(HttpServletRequest request, Model model) {        Member member = (Member) sessionManager.getSession(request);        if (member == null) {            return "home";        }        model.addAttribute("member", member);        return "loginHome";    }```ì„œë¸”ë¦¿ë„ ì„¸ì…˜ ê°œë…ì„ ì§€ì›í•œë‹¤.ì´ì œ ì§ì ‘ ë§Œë“œëŠ” ì„¸ì…˜ ë§ê³ , ì„œë¸”ë¦¿ì´ ê³µì‹ ì§€ì›í•˜ëŠ” ì„¸ì…˜ì„ ì•Œì•„ë³´ì. ì„œë¸”ë¦¿ì´ ê³µì‹ ì§€ì›í•˜ëŠ” ì„¸ì…˜ì€ ìš°ë¦¬ê°€ ì§ì ‘ ë§Œë“  ì„¸ì…˜ê³¼ ë™ì‘ ë°©ì‹ì´ ê±°ì˜ ê°™ë‹¤.ì¶”ê°€ë¡œ ì„¸ì…˜ì„ ì¼ì •ì‹œê°„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ í•´ë‹¹ ì„¸ì…˜ì„ ì‚­ì œí•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.<br/><br/><br/># ğŸ’¡ë¡œê·¸ì¸ ì²˜ë¦¬í•˜ê¸° - ì„œë¸”ë¦¿ HTTP ì„¸ì…˜ - `HttpSession`ì„œë¸”ë¦¿ì€ ì„¸ì…˜ì„ ìœ„í•´ `HttpSession` ì´ë¼ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ”ë°, ì§€ê¸ˆê¹Œì§€ ë‚˜ì˜¨ ë¬¸ì œë“¤ì„ í•´ê²°í•´ì¤€ë‹¤.**HttpSession ì†Œê°œ**ì„œë¸”ë¦¿ì´ ì œê³µí•˜ëŠ” `HttpSession` ë„ ê²°êµ­ ìš°ë¦¬ê°€ ì§ì ‘ ë§Œë“  `SessionManager` ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ë™ì‘í•œë‹¤.   ì„¸ì…˜ ìƒì„± ì‹œ WAS(ì—¬ê¸°ì„œëŠ” í†°ìº£ì…ë‹ˆë‹¤.)ì—ì„œ ìƒì„±í•œ ê³ ìœ í•œ ì„¸ì…˜ IDë¥¼ ì¿ í‚¤ë¡œ í´ë¼ì´ì–¸íŠ¸ì— ì €ì¥í•©ë‹ˆë‹¤.   ì„œë¸”ë¦¿ì„ í†µí•´ `HttpSession` ì„ ìƒì„±í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì¿ í‚¤ë¥¼ ìƒì„±í•œë‹¤. ì¿ í‚¤ ì´ë¦„ì´ `JSESSIONID` ì´ê³ , ê°’ì€ ì¶”ì • ë¶ˆê°€ëŠ¥í•œ ëœë¤ ê°’ì´ë‹¤.`Cookie: JSESSIONID=5B78E23B513F50164D6FDD8C97B0AD05`<br/>## âš¡ï¸HttpSession ì‚¬ìš©**ì„¸ì…˜ ìƒì„±ê³¼ ì¡°íšŒ**ì„¸ì…˜ì„ ìƒì„±í•˜ë ¤ë©´ `request.getSession(true)` ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.`public HttpSession getSession(boolean create);`ì„¸ì…˜ì˜ create ì˜µì…˜ì— ëŒ€í•´ ì•Œì•„ë³´ì.- `request.getSession(true)`    - ì„¸ì…˜ì´ ìˆìœ¼ë©´ ê¸°ì¡´ ì„¸ì…˜ì„ ë°˜í™˜í•œë‹¤.    - ì„¸ì…˜ì´ ì—†ìœ¼ë©´ ìƒˆë¡œìš´ ì„¸ì…˜ì„ ìƒì„±í•´ì„œ ë°˜í™˜í•œë‹¤.- `request.getSession(false)`    - ì„¸ì…˜ì´ ìˆìœ¼ë©´ ê¸°ì¡´ ì„¸ì…˜ì„ ë°˜í™˜í•œë‹¤.    - ì„¸ì…˜ì´ ì—†ìœ¼ë©´ ìƒˆë¡œìš´ ì„¸ì…˜ì„ ìƒì„±í•˜ì§€ ì•ŠëŠ”ë‹¤. `null` ì„ ë°˜í™˜í•œë‹¤.- `request.getSession()` : ì‹ ê·œ ì„¸ì…˜ì„ ìƒì„±í•˜ëŠ” `request.getSession(true)` ì™€ ë™ì¼í•˜ë‹¤.ì„¸ì…˜ì— ë°ì´í„°ë¥¼ ë³´ê´€í•˜ëŠ” ë°©ë²•ì€ `request.setAttribute(..)` ì™€ ë¹„ìŠ·í•˜ë‹¤. í•˜ë‚˜ì˜ ì„¸ì…˜ì— ì—¬ëŸ¬ ê°’ì„ ì €ì¥í•  ìˆ˜ ìˆë‹¤.- `session.setAttribute(SessionConst.LOGIN_MEMBER, loginMember);`: **ì„¸ì…˜ì— ë¡œê·¸ì¸ íšŒì› ì •ë³´ ë³´ê´€**- `session.invalidate()` : **ì„¸ì…˜ì„ ì œê±°í•œë‹¤.**- `session.getAttribute(SessionConst.LOGIN_MEMBER)` : **ë¡œê·¸ì¸ ì‹œì ì— ì„¸ì…˜ì— ë³´ê´€í•œ íšŒì› ê°ì²´ë¥¼ ì°¾ëŠ”ë‹¤.**<details><summary>ì„œë¸”ë¦¿ì´ ì œê³¤í•˜ëŠ” HttpSession ì„ ì´ìš©í•œ ë¡œê·¸ì¸ êµ¬í˜„</summary>**SessionConst**```javapublic class SessionConst {    public static final String LOGIN_MEMBER = "loginMember";}```- `HttpSession` ì— ë°ì´í„°ë¥¼ ë³´ê´€í•˜ê³  ì¡°íšŒí•  ë•Œ, ê°™ì€ ì´ë¦„ì´ ì¤‘ë³µ ë˜ì–´ ì‚¬ìš©ë˜ë¯€ë¡œ, ìƒìˆ˜ë¥¼ í•˜ë‚˜ ì •ì˜í–ˆë‹¤.**LoginController - loginV3()**```java@PostMapping("/login")public String loginV3(@Validated @ModelAttribute LoginForm form, BindingResult bindingResult, HttpServletRequest request) {    if (bindingResult.hasErrors()) {        return "/login/loginForm";    }    Member loginMember = loginService.login(form.getLoginId(), form.getPassword());    log.info("login? {}", loginMember);    if (loginMember == null) {        bindingResult.reject("loginFail", "ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ë§ì§€ ì•ŠìŠµë‹ˆë‹¤.");        return "login/loginForm";    }    // ì„¸ì…˜ì´ ìˆìœ¼ë©´ ì„¸ì…˜ ë°˜í™˜, ì—†ìœ¼ë©´ ì‹ ê·œ ì„¸ì…˜ ìƒì„±    HttpSession session = request.getSession();    // ì„¸ì…˜ì— ë¡œê·¸ì¸ íšŒì› ì •ë³´ ë³´ê´€    session.setAttribute(SessionConst.LOGIN_MEMBER, loginMember);        return "redirect:/";}```**LoginController - logoutV3()**```java@PostMapping("/logout")public String logoutV3(HttpServletRequest request) {    HttpSession session = request.getSession(false);    if (session != null) {        session.invalidate();    }    return "redirect:/";}```**HomeController - homeLoginV3()**```java@GetMapping("/")public String loginHomeV3(HttpServletRequest request, Model model) {    HttpSession session = request.getSession(false);    if (session == null) {        return "home";    }    Member member = (Member) session.getAttribute(SessionConst.LOGIN_MEMBER);        // ì„¸ì…˜ì— íšŒì› ë°ì´í„°ê°€ ì—†ìœ¼ë©´ home    if (member == null) {        return "home";    }    model.addAttribute("member", member);    return "loginHome";}```- `request.getSession(false)`: `request.getSession()` ë¥¼ ì‚¬ìš©í•˜ë©´ ê¸°ë³¸ ê°’ì´ `create: true` ì´ë¯€ë¡œ, ë¡œê·¸ì¸ í•˜ì§€ ì•Šì„ ì‚¬ìš©ìë„ ì˜ë¯¸ì—†ëŠ” ì„¸ì…˜ì´ ë§Œë“¤ì–´ì§„ë‹¤. ë”°ë¼ì„œ ì„¸ì…˜ì„ ì°¾ì•„ì„œ ì‚¬ìš©í•˜ëŠ” ì‹œì ì—ëŠ”`create: false` ì˜µì…˜ì„ ì‚¬ìš©í•´ì„œ ì„¸ì…˜ì„ ìƒì„±í•˜ì§€ ì•Šì•„ì•¼ í•œë‹¤.### â­ï¸if (loginMember == null)ì˜ ì¡´ì¬ ì´ìœ > ì„¸ì…˜ ì €ì¥ì†Œì— ì„¸ì…˜ì´ ì—†ëŠ” ê²½ìš°ëŠ” ìˆì§€ë§Œ, ì„¸ì…˜ì´ ìˆë‹¤ê³  í•˜ë©´ Member ê°ì²´ê°€ ë¬´ì¡°ê±´ ì¡´ì¬í•˜ëŠ” ê²ƒì´ ì•„ë‹Œê°€ìš”?ì„¸ì…˜ì€ ìˆì§€ë§Œ ì„¸ì…˜ì•ˆì— Member ê°ì²´ê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.  ì„¸ì…˜ì— ë‹¤ë¥¸ ë°ì´í„°ë§Œ ë“¤ì–´ìˆì„ ìˆ˜ë„ ìˆêµ¬ìš”.**(ì„¸ì…˜ì— íšŒì›ì„ ë§Œë“œëŠ” ê²ƒ ë¿ë§Œ ì•„ë‹ˆë¼ ì—¬ëŸ¬ ê²½ìš°ì— ì‚¬ìš©ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.)**  ì´ëŸ° ê²½ìš°ë„ ë°©ì–´ê°€ í•„ìš”í•©ë‹ˆë‹¤.</details>**ê²°ê³¼**![image](https://user-images.githubusercontent.com/83503188/210170532-c8ebb13c-4026-4ac9-b69b-605c41de1eb1.png)<br/><br/><br/>## âš¡ï¸ë¡œê·¸ì¸ ì²˜ë¦¬í•˜ê¸° - ì„œë¸”ë¦¿ HTTP ì„¸ì…˜ - `@SessionAttribute`ìŠ¤í”„ë§ì€ ì„¸ì…˜ì„ ë” í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ `@SessionAttribute` ì„ ì§€ì›í•œë‹¤.ì´ë¯¸ ë¡œê·¸ì¸ ëœ ì‚¬ìš©ìë¥¼ ì°¾ì„ ë•ŒëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•˜ë©´ ëœë‹¤.  **ì°¸ê³ ë¡œ ì´ ê¸°ëŠ¥ì€ ì„¸ì…˜ì„ ìƒì„±í•˜ì§€ ì•ŠëŠ”ë‹¤.**`@SessionAttribute(name = "loginMember", required = false) Member loginMember`**HomeController - homeLoginV3Spring()**```java    @GetMapping("/")    public String homeLoginV3Spring(            @SessionAttribute(name = SessionConst.LOGIN_MEMBER, required = false) Member loginMember, Model model) {        if (loginMember == null) {            return "home";        }        //ì„¸ì…˜ì´ ìœ ì§€ë˜ë©´ ë¡œê·¸ì¸ìœ¼ë¡œ ì´ë™        model.addAttribute("member", loginMember);        return "loginHome";    }```## âš¡ï¸TrackingModesë¡œê·¸ì¸ì„ ì²˜ìŒ ì‹œë„í•˜ë©´ URLì´ ë‹¤ìŒê³¼ ê°™ì´ jsessionid ë¥¼ í¬í•¨í•˜ê³  ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.![image](https://user-images.githubusercontent.com/83503188/210170711-4226a4b6-3ca4-4e11-bdfe-7c9fc8ac69fb.png)ì´ê²ƒì€ ì›¹ ë¸Œë¼ìš°ì €ê°€ ì¿ í‚¤ë¥¼ ì§€ì›í•˜ì§€ ì•Šì„ ë•Œ ì¿ í‚¤ ëŒ€ì‹  URLì„ í†µí•´ì„œ ì„¸ì…˜ì„ ìœ ì§€í•˜ëŠ” ë°©ë²•ì´ë‹¤. ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë ¤ë©´ URLì— ì´ ê°’ì„ ê³„ì† í¬í•¨í•´ì„œ ì „ë‹¬í•´ì•¼ í•œë‹¤.íƒ€ì„ë¦¬í”„ ê°™ì€ í…œí”Œë¦¿ì€ ì—”ì§„ì„ í†µí•´ì„œ ë§í¬ë¥¼ ê±¸ë©´ `jsessionid` ë¥¼ URLì— ìë™ìœ¼ë¡œ í¬í•¨í•´ì¤€ë‹¤. ì„œë²„ ì…ì¥ì—ì„œ ì›¹ ë¸Œë¼ìš°ì €ê°€ ì¿ í‚¤ë¥¼ ì§€ì›í•˜ëŠ”ì§€ í•˜ì§€ ì•ŠëŠ”ì§€ ìµœì´ˆì—ëŠ” íŒë‹¨í•˜ì§€ ëª»í•˜ë¯€ë¡œ, ì¿ í‚¤ ê°’ë„ ì „ë‹¬í•˜ê³ , URLì— jsessionid ë„ í•¨ê»˜ ì „ë‹¬í•œë‹¤.URL ì „ë‹¬ ë°©ì‹ì„ ë„ê³  í•­ìƒ ì¿ í‚¤ë¥¼ í†µí•´ì„œë§Œ ì„¸ì…˜ì„ ìœ ì§€í•˜ê³  ì‹¶ìœ¼ë©´ ë‹¤ìŒ ì˜µì…˜ì„ ë„£ì–´ì£¼ë©´ ëœë‹¤. ì´ë ‡ê²Œ í•˜ë©´ URLì— `jsessionid` ê°€ ë…¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.```propertiesserver.servlet.session.tracking-modes=cookie```<br/><br/><br/># ğŸ’¡ì„¸ì…˜ ì •ë³´ì™€ íƒ€ì„ì•„ì›ƒ ì„¤ì •## âš¡ï¸ì„¸ì…˜ ì •ë³´ í™•ì¸**SessionInfoController**```java@Slf4j@RestControllerpublic class SessionInfoController {    @GetMapping("/session-info")    public String sessionInfo(HttpServletRequest request) {        HttpSession session = request.getSession(false);        if (session == null) {            return "ì„¸ì…˜ì´ ì—†ìŠµë‹ˆë‹¤.";        }        //ì„¸ì…˜ ë°ì´í„° ì¶œë ¥        session.getAttributeNames().asIterator()                .forEachRemaining(name -> log.info("session name={}, value={}",                        name, session.getAttribute(name)));        log.info("sessionId={}", session.getId());        log.info("maxInactiveInterval={}", session.getMaxInactiveInterval());        log.info("creationTime={}", new Date(session.getCreationTime()));        log.info("lastAccessedTime={}", new Date(session.getLastAccessedTime()));        log.info("isNew={}", session.isNew());        return "ì„¸ì…˜ ì¶œë ¥";    }}```- `sessionId` : ì„¸ì…˜Id, `JSESSIONID` ì˜ ê°’ì´ë‹¤. ì˜ˆ) 34B14F008AA3527C9F8ED620EFD7A4E1- `maxInactiveInterval` : ì„¸ì…˜ì˜ ìœ íš¨ ì‹œê°„, ì˜ˆ) 1800ì´ˆ, (30ë¶„)- `creationTime` : ì„¸ì…˜ ìƒì„±ì¼ì‹œ- `lastAccessedTime` : ì„¸ì…˜ê³¼ ì—°ê²°ëœ ì‚¬ìš©ìê°€ ìµœê·¼ì— ì„œë²„ì— ì ‘ê·¼í•œ ì‹œê°„, í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ`sessionId` ( `JSESSIONID` )ë¥¼ ìš”ì²­í•œ ê²½ìš°ì— ê°±ì‹ ëœë‹¤.- `isNew` : ìƒˆë¡œ ìƒì„±ëœ ì„¸ì…˜ì¸ì§€, ì•„ë‹ˆë©´ ì´ë¯¸ ê³¼ê±°ì— ë§Œë“¤ì–´ì¡Œê³ , í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ`sessionId` ( `JSESSIONID` )ë¥¼ ìš”ì²­í•´ì„œ ì¡°íšŒëœ ì„¸ì…˜ì¸ì§€ ì—¬ë¶€![mySessionInfo](https://github.com/LeeHyungGeol/Algorithm_BaekJoon/assets/56071088/945e8f4f-684a-4505-9f64-9cfc06a879a3)<br/>## âš¡ï¸ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì •ì„¸ì…˜ì€ ì‚¬ìš©ìê°€ ë¡œê·¸ì•„ì›ƒì„ ì§ì ‘ í˜¸ì¶œí•´ì„œ `session.invalidate()` ê°€ í˜¸ì¶œ ë˜ëŠ” ê²½ìš°ì— ì‚­ì œëœë‹¤.ê·¸ëŸ°ë° ëŒ€ë¶€ë¶„ì˜ ì‚¬ìš©ìëŠ” ë¡œê·¸ì•„ì›ƒì„ ì„ íƒí•˜ì§€ ì•Šê³ , ê·¸ëƒ¥ ì›¹ ë¸Œë¼ìš°ì €ë¥¼ ì¢…ë£Œí•œë‹¤. ë¬¸ì œëŠ” HTTP ê°€ ë¹„ ì—°ê²°ì„±(ConnectionLess)ì´ë¯€ë¡œ ì„œë²„ ì…ì¥ì—ì„œëŠ” í•´ë‹¹ ì‚¬ìš©ìê°€ ì›¹ ë¸Œë¼ìš°ì €ë¥¼ ì¢…ë£Œí•œ ê²ƒì¸ì§€ ì•„ë‹Œì§€ë¥¼ ì¸ì‹í•  ìˆ˜ ì—†ë‹¤.ë”°ë¼ì„œ ì„œë²„ì—ì„œ ì„¸ì…˜ ë°ì´í„°ë¥¼ ì–¸ì œ ì‚­ì œí•´ì•¼ í•˜ëŠ”ì§€ íŒë‹¨í•˜ê¸°ê°€ ì–´ë µë‹¤.ì´ ê²½ìš° ë‚¨ì•„ìˆëŠ” ì„¸ì…˜ì„ ë¬´í•œì • ë³´ê´€í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.- ì„¸ì…˜ê³¼ ê´€ë ¨ëœ ì¿ í‚¤( `JSESSIONID` )ë¥¼ íƒˆì·¨ ë‹¹í–ˆì„ ê²½ìš° ì˜¤ëœ ì‹œê°„ì´ ì§€ë‚˜ë„ í•´ë‹¹ ì¿ í‚¤ë¡œ ì•…ì˜ì ì¸ ìš”ì²­ì„ í•  ìˆ˜ ìˆë‹¤.- **ì„¸ì…˜ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë©”ëª¨ë¦¬ì— ìƒì„±ëœë‹¤. ë©”ëª¨ë¦¬ì˜ í¬ê¸°ê°€ ë¬´í•œí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ê¼­ í•„ìš”í•œ ê²½ìš°ë§Œ ìƒì„±í•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.** 10ë§Œëª…ì˜ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•˜ë©´ 10ë§Œê°œì˜ ì„¸ì…˜ì´ ìƒì„±ë˜ëŠ” ê²ƒì´ë‹¤.**ì„¸ì…˜ì˜ ì¢…ë£Œ ì‹œì **ì„¸ì…˜ì˜ ì¢…ë£Œ ì‹œì ì„ ì–´ë–»ê²Œ ì •í•˜ë©´ ì¢‹ì„ê¹Œ? ê°€ì¥ ë‹¨ìˆœí•˜ê²Œ ìƒê°í•´ë³´ë©´, ì„¸ì…˜ ìƒì„± ì‹œì ìœ¼ë¡œë¶€í„° 30ë¶„ ì •ë„ë¡œ ì¡ìœ¼ë©´ ë  ê²ƒ ê°™ë‹¤.ê·¸ëŸ°ë° ë¬¸ì œëŠ” 30ë¶„ì´ ì§€ë‚˜ë©´ ì„¸ì…˜ì´ ì‚­ì œë˜ê¸° ë•Œë¬¸ì—, ì—´ì‹¬íˆ ì‚¬ì´íŠ¸ë¥¼ ëŒì•„ë‹¤ë‹ˆë‹¤ê°€ ë˜ ë¡œê·¸ì¸ì„ í•´ì„œ ì„¸ì…˜ì„ ìƒì„±í•´ì•¼ í•œë‹¤ ê·¸ëŸ¬ë‹ˆê¹Œ 30ë¶„ ë§ˆë‹¤ ê³„ì† ë¡œê·¸ì¸í•´ì•¼ í•˜ëŠ” ë²ˆê±°ë¡œì›€ì´ ë°œìƒí•œë‹¤.***ë” ë‚˜ì€ ëŒ€ì•ˆì€ ì„¸ì…˜ ìƒì„± ì‹œì ì´ ì•„ë‹ˆë¼ ì‚¬ìš©ìê°€ ì„œë²„ì— ìµœê·¼ì— ìš”ì²­í•œ ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ 30ë¶„ ì •ë„ë¥¼ ìœ ì§€í•´ì£¼ëŠ” ê²ƒì´ë‹¤.***   ì´ë ‡ê²Œ í•˜ë©´ ì‚¬ìš©ìê°€ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë©´, ì„¸ì…˜ì˜ ìƒì¡´ ì‹œê°„ì´ 30ë¶„ìœ¼ë¡œ ê³„ì† ëŠ˜ì–´ë‚˜ê²Œ ëœë‹¤.ë”°ë¼ì„œ 30ë¶„ ë§ˆë‹¤ ë¡œê·¸ì¸í•´ì•¼ í•˜ëŠ” ë²ˆê±°ë¡œì›€ì´ ì‚¬ë¼ì§„ë‹¤. `HttpSession` ì€ ì´ ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤.**ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì„¤ì •**`application.properties````propertiesserver.servlet.session.timeout=60 ```- 60ì´ˆ, ê¸°ë³¸ì€ 1800(30ë¶„)- íŠ¹ì • ì„¸ì…˜ ë‹¨ìœ„ë¡œ ì‹œê°„ ì„¤ì •    - `session.setMaxInactiveInterval(1800);`: 1800ì´ˆ**ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ë°œìƒ**ì„¸ì…˜ì˜ íƒ€ì„ì•„ì›ƒ ì‹œê°„ì€ í•´ë‹¹ ì„¸ì…˜ê³¼ ê´€ë ¨ëœ `JSESSIONID` ë¥¼ ì „ë‹¬í•˜ëŠ” HTTP ìš”ì²­ì´ ìˆìœ¼ë©´ í˜„ì¬ ì‹œê°„ìœ¼ë¡œ ë‹¤ì‹œ ì´ˆê¸°í™” ëœë‹¤.ì´ë ‡ê²Œ ì´ˆê¸°í™” ë˜ë©´ ì„¸ì…˜ íƒ€ì„ì•„ì›ƒìœ¼ë¡œ ì„¤ì •í•œ ì‹œê°„ë™ì•ˆ ì„¸ì…˜ì„ ì¶”ê°€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.`LastAccessedTime` ì´í›„ë¡œ timeout ì‹œê°„ì´ ì§€ë‚˜ë©´, **WASê°€ ë‚´ë¶€ì—ì„œ í•´ë‹¹ ì„¸ì…˜ì„ ì œê±°í•œë‹¤.**<br/><br/><br/># ğŸ’¡ì„¸ì…˜(Session) ì •ë¦¬> ### **ì„¸ì…˜(Session)ì´ë€**> > ì„œë²„ì— ì¤‘ìš”í•œ ì •ë³´ë¥¼ ë³´ê´€í•˜ê³  ì—°ê²°ì„ ìœ ì§€í•˜ëŠ” ë°©ë²•ì„¸ì…˜ë„ ê²°êµ­ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•œë‹¤!!ì°¨ì´ì ì€ ì‚¬ìš©ìì˜ ì •ë³´ ì €ì¥ ìœ„ì¹˜ì´ë‹¤. ì„¸ì…˜ì€ ì„œë²„ì— ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ì €ì¥í•œë‹¤.**ì„¸ì…˜ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•œë‹¤. ë©”ëª¨ë¦¬ì˜ í¬ê¸°ê°€ ë¬´í•œí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ê¼­ í•„ìš”í•œ ì •ë³´ë§Œ ìƒì„±í•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.**ì„¸ì…˜ì˜ ê¸°ë³¸ íƒ€ì„ì•„ì›ƒì€ 30ë¶„ì´ë‹¤.**ì„¸ì…˜ì˜ ì¢…ë£Œì‹œì ì€ ì‚¬ìš©ìê°€ ë§ˆì§€ë§‰ìœ¼ë¡œ ì„œë²„ì— ìš”ì²­í•œ ì‹œê°„ì„ ê¸°ì¤€ìœ¼ë¡œ 30ë¶„ ì •ë„ë¥¼ ìœ ì§€í•´ì£¼ëŠ” ê²ƒì´ë‹¤.****timeout ì‹œê°„ì´ ì§€ë‚˜ë©´, WAS(Spring Boot ê¸°ì¤€ Tomcat)ê°€ ë‚´ë¶€ì—ì„œ í•´ë‹¹ ì„¸ì…˜ì„ ì œê±°í•œë‹¤.**ì°¸ê³ : https://interconnection.tistory.com/74<br/><br/>## âš¡ï¸ì„¸ì…˜ ì €ì¥ì†Œì˜ í˜•íƒœ![HttpSession á„ƒá…©á†¼á„Œá…¡á†¨á„‹á…¯á†«á„…á…µ](https://github.com/LeeHyungGeol/Algorithm_BaekJoon/assets/56071088/d11afe04-d07a-4821-990c-825849fc50ae)ì„¸ì…˜ ì €ì¥ì†Œì˜ í˜•íƒœëŠ” `Map<JSESSIONID, ConcurrentMap<String, Object>>` ì´ë‹¤.ì‹¤ì œ ìš°ë¦¬ê°€ ì €ì¥í•˜ëŠ” ì •ë³´ëŠ”  `protected ConcurrentMap<String, Object> attributes = new ConcurrentHashMap();`  `attributes` ë¼ëŠ” ì´ë¦„ì˜ ConcurrentHashMap ì— ì €ì¥ëœë‹¤.ìì„¸í•œ ê²ƒì€ `HttpSession` ì¸í„°í˜ì´ìŠ¤ì™€ êµ¬í˜„ì²´ ì¤‘ `StandardSession` ì„ ì‚´í´ë³´ì.<br/><br/>## âš¡ï¸ì„¸ì…˜ì˜ ë™ì‘ ì›ë¦¬`HttpSession session = request.getSession();`1. (ì„¸ì…˜ì´ ì—†ë‹¤ë©´)2. ì‚¬ìš©ìì˜ request ì •ë³´ë¥¼ ê°€ì§€ê³  WAS(Spring Boot ê¸°ì¤€ Tomcat)ì—ì„œ í‚¤(JSESSIONID)ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. (UUID ì˜ í˜•íƒœ)   - í†°ìº£(Tomcat) ê¸°ì¤€ `ManagerBase` í´ë˜ìŠ¤ì˜ `createSession` ë©”ì„œë“œì—ì„œ     `StandardSessionIdGenerator` í´ë˜ìŠ¤ì˜ `generateSessionId` ë©”ì„œë“œë¥¼ ì´ìš©í•˜ì—¬ `JSESSIONID` ë¥¼ ìƒì„±í•œë‹¤. 3. ì‘ë‹µ í—¤ë”ì— í‚¤ë¥¼ ì €ì¥í•œë‹¤.4. í•´ë‹¹ í‚¤ë¥¼ ê°€ì§€ê³  ì„¸ì…˜ì„ ìƒì„±í•œë‹¤.1. (ì„¸ì…˜ì´ ìˆë‹¤ë©´)2. ì‚¬ìš©ìì˜ request ì •ë³´ì—ì„œ JSESSIONID ë¥¼ ì´ìš©í•˜ì—¬ ì‚¬ìš©ìì˜ ì •ë³´ì— ë§ëŠ” session ì„ ë°˜í™˜í•´ì¤€ë‹¤.`session.setAttribute(SESSION_CONST.LOGIN_MEMBER, member);`1. ì‚¬ìš©ìì˜ session ì— ì›í•˜ëŠ” ì •ë³´ë¥¼ ì €ì¥í•œë‹¤.<br/><br/>ì‹¤ì œë¡œ JSESSIONID ë¥¼ ë§Œë“œëŠ” ë¶€ë¶„ì€ org.apache.catalina.session íŒ¨í‚¤ì§€ì˜ `ManagerBase` í´ë˜ìŠ¤ì˜ `createSession` ë©”ì†Œë“œì—ì„œ `JSESSIONID` ë¥¼ ì•„ë˜ì™€ ê°™ì´ ìƒì„± í•˜ê²Œ ë©ë‹ˆë‹¤.```javapackage org.apache.catalina.session;public abstract class ManagerBase extends LifecycleMBeanBase implements Manager {    ......        public Session createSession(String sessionId) {        if ((maxActiveSessions >= 0) &&                (getActiveSessions() >= maxActiveSessions)) {            rejectedSessions++;            throw new TooManyActiveSessionsException(                    sm.getString("managerBase.createSession.ise"),                    maxActiveSessions);        }        // Recycle or create a Session instance        Session session = createEmptySession();        // Initialize the properties of the new session and return it        session.setNew(true);        session.setValid(true);        session.setCreationTime(System.currentTimeMillis());        session.setMaxInactiveInterval(getContext().getSessionTimeout() * 60);        String id = sessionId;        if (id == null) {            id = generateSessionId();        }        session.setId(id);        sessionCounter++;        SessionTiming timing = new SessionTiming(session.getCreationTime(), 0);        synchronized (sessionCreationTiming) {            sessionCreationTiming.add(timing);            sessionCreationTiming.poll();        }        return session;    }}```ê·¸ë¦¬ê³  ìœ„ì˜ ì½”ë“œ ì²˜ëŸ¼ createSession ë©”ì†Œë“œëŠ” ë‚´ë¶€ì ìœ¼ë¡œ org.apache.catalina.util íŒ¨í‚¤ì§€ì˜  `StandardSessionIdGenerator` í´ë˜ìŠ¤ì˜ `generateSessionId` ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ `JSESSIONID` ë¥¼ ìƒì„±í•˜ê²Œ ë©ë‹ˆë‹¤.```javapackage org.apache.catalina.util;public class StandardSessionIdGenerator extends SessionIdGeneratorBase {    @Override    public String generateSessionId(String route) {        byte random[] = new byte[16];        int sessionIdLength = getSessionIdLength();        // Render the result as a String of hexadecimal digits        // Start with enough space for sessionIdLength and medium route size        StringBuilder buffer = new StringBuilder(2 * sessionIdLength + 20);        int resultLenBytes = 0;        while (resultLenBytes < sessionIdLength) {            getRandomBytes(random);            for (int j = 0;            j < random.length && resultLenBytes < sessionIdLength;            j++) {                byte b1 = (byte) ((random[j] & 0xf0) >> 4);                byte b2 = (byte) (random[j] & 0x0f);                if (b1 < 10)                    buffer.append((char) ('0' + b1));                else                    buffer.append((char) ('A' + (b1 - 10)));                if (b2 < 10)                    buffer.append((char) ('0' + b2));                else                    buffer.append((char) ('A' + (b2 - 10)));                resultLenBytes++;            }        }        if (route != null && route.length() > 0) {            buffer.append('.').append(route);        } else {            String jvmRoute = getJvmRoute();            if (jvmRoute != null && jvmRoute.length() > 0) {                buffer.append('.').append(jvmRoute);            }        }        return buffer.toString();    }}```ì°¸ê³ : https://semtax.tistory.com/92