# ì„œë¸”ë¦¿

<br/>

## ëª©ì°¨
- HttpServletRequest ê°œìš”
- HttpServletRequest - ê¸°ë³¸ ì‚¬ìš©ë²•
- HTTP ìš”ì²­ ë°ì´í„°
- HttpServletResponse


<br/>

<br/>

<br/>


# ğŸ’¡ HttpServletRequest ê°œìš”

<br/>

## âš¡ï¸ HttpServletRequest ì—­í• 
ì„œë¸”ë¦¿ì€ **`HTTP ìš”ì²­ ë©”ì‹œì§€ë¥¼ íŒŒì‹±`í•˜ê³  ê·¸ ê²°ê³¼ë¥¼ `HttpServletRequest ê°ì²´`ì— ë‹´ì•„ì„œ ì œê³µí•œë‹¤.**

![http-message-get](https://user-images.githubusercontent.com/50267433/126497276-f0ddfed0-9b91-46fa-a26f-51056feec165.PNG)

```http
POST /save HTTP/1.1                                     # START LINE
Host: localhost:8080                                    # HEADER
Content-Type: application/x-www-form-urlencoded         # HTML FORM ìœ¼ë¡œ ì „ì†¡  

username=kim&age=20                                     # BODY
```
ì¦‰, ì„œë¸”ë¦¿ì€ ìœ„ì™€ ê°™ì€ `HTTP ìš”ì²­ ë©”ì‹œì§€` íŒŒì‹±í•´ì„œ `HttpServletRequest ê°ì²´`ë¥¼ ë§Œë“¤ê³   
`HttpServletRequest ê°ì²´`ë¥¼ í†µí•´ ìš°ë¦¬ëŠ” ì•„ë˜ì™€ ê°™ì€ HTTP ìš”ì†Œë“¤ì„ í¸ë¦¬í•˜ê²Œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.

* **START LINE**
    * HTTP ë©”ì†Œë“œ
    * URL
    * ì¿¼ë¦¬ ìŠ¤íŠ¸ë§
    * ìŠ¤í‚¤ë§ˆ, í”„ë¡œí† ì½œ
* **í—¤ë”**
    * í—¤ë” ì¡°íšŒ
* **ë°”ë””**
    * form íŒŒë¼ë¯¸í„° í˜•ì‹ ì¡°íšŒ
    * message body ë°ì´í„° ì§ì ‘ ì¡°íšŒ

`HttpServletRequest`, `HttpServletResponse`ëŠ”              
HTTP ìš”ì²­ ë©”ì‹œì§€, HTTP ì‘ë‹µ ë©”ì‹œì§€ë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•˜ë„ë¡ ë„ì™€ì£¼ëŠ” ê°ì²´ë‹¤.        
ë”°ë¼ì„œ ê¹Šì´ìˆëŠ” ì´í•´ë¥¼ í•˜ë ¤ë©´ **HTTP ìŠ¤í™ì´ ì œê³µí•˜ëŠ” ìš”ì²­, ì‘ë‹µ ë©”ì‹œì§€ ìì²´ë¥¼ ì´í•´í•´ë©´ ì¢‹ë‹¤.**

ì°¸ê³ ë¡œ, `HttpServletRequest` ê°ì²´ëŠ” ì¶”ê°€ë¡œ ì—¬ëŸ¬ê°€ì§€ ë¶€ê°€ê¸°ëŠ¥ë„ í•¨ê»˜ ì œê³µí•œë‹¤.

1. ì„ì‹œ ì €ì¥ì†Œ ê¸°ëŠ¥
2. ì„¸ì…˜ ê´€ë¦¬ ê¸°ëŠ¥

<br/>

<br/>

## âš¡ï¸ ì„ì‹œ ì €ì¥ì†Œ ê¸°ëŠ¥
http ìš”ì²­ ë©”ì„¸ì§€ê°€ ê³ ê°ì˜ ìš”ì²­ì´ ì˜¤ê³  ê³ ê°ì˜ ìš”ì²­ì˜ ì‘ë‹µì´ ë‚˜ê°ˆ ë•Œê¹Œì§€ ìƒì¡´ ë²”ìœ„ì´ë‹¤.

í•´ë‹¹ HTTP ìš”ì²­ì´ ì‹œì‘ë¶€í„° ëë‚  ë•Œ ê¹Œì§€ ìœ ì§€ë˜ëŠ” ì„ì‹œ ì €ì¥ì†Œ ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆë‹¤.  
ì‚¬ìš© ë°©ë²•ì€ `Session` ê³¼ ë¹„ìŠ·í•˜ë‹¤.

* **ì €ì¥ :** request.setAttribute(name, value)
* **ì¡°íšŒ :** request.getAttribute(name)

<br/>

## âš¡ï¸ ì„¸ì…˜ ê´€ë¦¬ ê¸°ëŠ¥
`request`ë¡œë¶€í„° ì„¸ì…˜ ìƒì„±ê³¼ ê´€ë ¨ëœ ê¸°ëŠ¥ì„ ì œê³µí•´ì¤€ë‹¤.

```java
request.getSession(create: true)
```
`request.getSession()`ì€ ê¸°ì¡´ì— ì´ë¯¸ ì—°ê²°ëœ ì„¸ì…˜ì´ ìˆë‹¤ë©´ í•´ë‹¹ ì„¸ì…˜ì„ ë°˜í™˜í•´ì¤€ë‹¤.  
ë§Œì•½, ì—†ìœ¼ë©´ ì•„ë˜ì™€ ê°™ì€ ë™ì‘ì„ í•œë‹¤.

* `request.getSession(true);` : ìƒˆë¡œ ë°˜í™˜
* `request.getSession(false);` : null ë°˜í™˜

<br/>

<br/>

<br/>

# ğŸ’¡ HttpServletRequest - ê¸°ë³¸ ì‚¬ìš©ë²•

```java
    @WebServlet(name = "requestHeaderServlet", urlPatterns = "/request-header")
    public class RequestHeaderServlet extends HttpServlet {
        @Override
        protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
            printStartLine(request);
            printHeaders(request);
            printHeaderUtils(request);
            printEtc(request);
            response.getWriter().write("ok");
        }
    }
```

<br/>

## âš¡ï¸ START LINE
```java
    private void printStartLine(HttpServletRequest request) {
        // http://localhost:8080/request-header?username=hello
        System.out.println("--- REQUEST-LINE - start ---");
        System.out.println("request.getMethod() = " + request.getMethod());             // GET
        System.out.println("request.getProtocal() = " + request.getProtocol());         // HTTP / 1.1
        System.out.println("request.getScheme() = " + request.getScheme());             // http
        
        System.out.println("request.getRequestURL() = " + request.getRequestURL());     // http://localhost:8080/request-header?username=hello 
        System.out.println("request.getRequestURI() = " + request.getRequestURI());     // /request-header 
        System.out.println("request.getQueryString() = " + request.getQueryString());   // username=hello
        System.out.println("request.isSecure() = " + request.isSecure());               // https ì‚¬ìš© ìœ ë¬´
        System.out.println("--- REQUEST-LINE - end ---");
        System.out.println();
    }
```
```sh
--- REQUEST-LINE - start ---
request.getMethod() = GET
request.getProtocol() = HTTP/1.1
request.getScheme() = http
request.getRequestURL() = http://localhost:8080/request-header
request.getRequestURI() = /request-header
request.getQueryString() = username=hello
request.isSecure() = false
--- REQUEST-LINE - end ---
```

<br/>


## âš¡ï¸ HEADER

```java
//Header ëª¨ë“  ì •ë³´
private void printHeaders(HttpServletRequest request) {
  System.out.println("--- Headers - start ---");
 /*
     Enumeration<String> headerNames = request.getHeaderNames();
     while (headerNames.hasMoreElements()) {
         String headerName = headerNames.nextElement();
         System.out.println(headerName + ": " + request.getHeader(headerName));
     }
*/
  request.getHeaderNames().asIterator()
          .forEachRemaining(headerName -> System.out.println(headerName + ": " + request.getHeader(headerName)));
  System.out.println("--- Headers - end ---");
  System.out.println();
}
```
```sh
--- Headers - start ---
host: localhost:8080
connection: keep-alive
cache-control: max-age=0
sec-ch-ua: "Not A(Brand";v="99", "Google Chrome";v="121", "Chromium";v="121"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "macOS"
upgrade-insecure-requests: 1
user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36
accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
sec-fetch-site: none
sec-fetch-mode: navigate
sec-fetch-user: ?1
sec-fetch-dest: document
accept-encoding: gzip, deflate, br
accept-language: ko-KR,ko;q=0.9,en-US;q=0.8,en;q=0.7
cookie: Idea-220bc51d=e9f14649-55a9-4b85-b53c-d84556a3fbc3
--- Headers - end ---
```

<br/>


## âš¡ï¸ HEADER í¸ë¦¬í•œ ì¡°íšŒ
```java
//Header í¸ë¦¬í•œ ì¡°íšŒ
private void printHeaderUtils(HttpServletRequest request) {
  System.out.println("--- Header í¸ì˜ ì¡°íšŒ start ---"); System.out.println("[Host í¸ì˜ ì¡°íšŒ]");
  System.out.println("request.getServerName() = " + request.getServerName()); //Host í—¤ë”
  System.out.println("request.getServerPort() = " + request.getServerPort()); //Host í—¤ë” 
  System.out.println();

  System.out.println("[Accept-Language í¸ì˜ ì¡°íšŒ]");
  request.getLocales().asIterator().forEachRemaining(locale -> System.out.println("locale = " +locale));

  System.out.println("request.getLocale() = " + request.getLocale());
  System.out.println();

  System.out.println("[cookie í¸ì˜ ì¡°íšŒ]");
  if (request.getCookies() != null) {
    for (Cookie cookie : request.getCookies()) {
      System.out.println(cookie.getName() + ": " + cookie.getValue());
    }
  }
  System.out.println();

  System.out.println("[Content í¸ì˜ ì¡°íšŒ]");
  System.out.println("request.getContentType() = " + request.getContentType());
  System.out.println("request.getContentLength() = " + request.getContentLength());
  System.out.println("request.getCharacterEncoding() = " + request.getCharacterEncoding());

  System.out.println("--- Header í¸ì˜ ì¡°íšŒ end ---");
  System.out.println();
}
```
```sh
--- Header í¸ì˜ ì¡°íšŒ start ---
[Host í¸ì˜ ì¡°íšŒ]
request.getServerName() = localhost
request.getServerPort() = 8080
[Accept-Language í¸ì˜ ì¡°íšŒ]
locale = ko_KR
locale = ko
locale = en_US
locale = en
request.getLocale() = ko_KR

[cookie í¸ì˜ ì¡°íšŒ]
Idea-220bc51d: e9f14649-55a9-4b85-b53c-d84556a3fbc3

[Content í¸ì˜ ì¡°íšŒ]
request.getContentType() = null
request.getContentLength() = -1
request.getCharacterEncoding() = UTF-8
--- Header í¸ì˜ ì¡°íšŒ end ---
```

<br/>


## âš¡ï¸ ê¸°íƒ€ ì¡°íšŒ
```java
//ê¸°íƒ€ ì •ë³´
private void printEtc(HttpServletRequest request) {
  System.out.println("--- ê¸°íƒ€ ì¡°íšŒ start ---");
  System.out.println("[Remote ì •ë³´]");
  System.out.println("request.getRemoteHost() = " + request.getRemoteHost());
  System.out.println("request.getRemoteAddr() = " + request.getRemoteAddr());
  System.out.println("request.getRemotePort() = " + request.getRemotePort());
  System.out.println();

  System.out.println("[Local ì •ë³´]");
  System.out.println("request.getLocalName() = " + request.getLocalName());
  System.out.println("request.getLocalAddr() = " + request.getLocalAddr());
  System.out.println("request.getLocalPort() = " + request.getLocalPort());
  System.out.println("--- ê¸°íƒ€ ì¡°íšŒ end ---");
  System.out.println();
}
```
```sh
--- ê¸°íƒ€ ì¡°íšŒ start ---
[Remote ì •ë³´]
request.getRemoteHost() = 0:0:0:0:0:0:0:1
request.getRemoteAddr() = 0:0:0:0:0:0:0:1
request.getRemotePort() = 56628

[Local ì •ë³´]
request.getLocalName() = localhost
request.getLocalAddr() = 0:0:0:0:0:0:0:1
request.getLocalPort() = 8080
--- ê¸°íƒ€ ì¡°íšŒ end ---
```

<br/>

<br/>


**ì°¸ê³ **
> ë¡œì»¬ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ë©´ IPv6 ì •ë³´ê°€ ë‚˜ì˜¤ëŠ”ë°, IPv4 ì •ë³´ë¥¼ ë³´ê³  ì‹¶ìœ¼ë©´ ë‹¤ìŒ ì˜µì…˜ì„ VM optionsì—ë„£ì–´ì£¼ë©´ ëœë‹¤.   
> -Djava.net.preferIPv4Stack=true      

<br/>

<br/>

<br/>


# ğŸ’¡HTTP ìš”ì²­ ë°ì´í„°

## âš¡ï¸ ê°œìš”
`HTTP ìš”ì²­ ë©”ì‹œì§€`ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì „ë‹¬í• ë•Œ ì£¼ë¡œ 3ê°€ì§€ ë°©ë²•ì„ ì‚¬ìš©í•œë‹¤.

**GET - ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°**
  * `/url?username=hello&age=20`
  * ë©”ì‹œì§€ ë°”ë”” ì—†ì´, URL ì˜ Query Parameter ì— ë°ì´í„°ë¥¼ í¬í•¨í•´ì„œ ì „ë‹¬
  * ì˜ˆ) ê²€ìƒ‰, í•„í„°, í˜ì´ì§• ë“±ì—ì„œ ë§ì´ ì‚¬ìš©í•˜ëŠ” ë°©ì‹

**POST - HTML Form**
  * `content-type: application/x-www-form-urlencoded`
  * **Message Body ì— Query Parameter í˜•ì‹ìœ¼ë¡œ ì „ë‹¬ username=hello&age=20**
  * ì˜ˆ) íšŒì› ê°€ì…, ìƒí’ˆ ì£¼ë¬¸, HTML Form ì‚¬ìš©

**âœ” HTTP message bodyì— ë°ì´í„°ë¥¼ ì§ì ‘ ë‹´ì•„ì„œ ìš”ì²­**
  * HTTP APIì—ì„œ ì£¼ë¡œ ì‚¬ìš©, JSON, XML, TEXT
  * ë°ì´í„° í˜•ì‹ì€ ì£¼ë¡œ JSON ì‚¬ìš©
  * POST, PUT, PATCH

<br/>

<br/>

<br/>

# ğŸ’¡ HTTP ìš”ì²­ ë°ì´í„° - GET ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°
`GET ë°©ì‹`ì€ **ë©”ì‹œì§€ ë°”ë”” ì—†ì´, URLì˜ `Query Parameter`ë¥¼ ì‚¬ìš©í•´ì„œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ì‹**ìœ¼ë¡œ    
ì£¼ë¡œ `ê²€ìƒ‰`, `í•„í„°`, `í˜ì´ì§•`ë“±ì—ì„œ ë§ì´ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ë‹¤.

```url
http://localhost:8080/request-param?username=hello&age=20
```  
```http
GET /test?username=hello&age=20 HTTP/1.1
Host: localhost:8080  
Content-Type: application/x-www-form-urlencoded          

username=hello&age=20   
```

`ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°`ëŠ” URLì— `?`ë¥¼ ì‹œì‘ìœ¼ë¡œ ì…ë ¥ ë° `&` ë¡œ êµ¬ë¶„í•˜ëŠ” íŒŒë¼ë¯¸í„°ë¥¼ ì˜ë¯¸í•œë‹¤.     
ì„œë²„ì—ì„œëŠ” `HttpServletRequest`ë©”ì„œë“œë¥¼ í†µí•´ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¥¼ í¸ë¦¬í•˜ê²Œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.

<br/>

<br/>

## âš¡ï¸ GET ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì¡°íšŒ
**ë‹¨ì¼ íŒŒë¼ë¯¸í„° ì¡°íšŒ**
```java
String username = request.getParameter("username"); 
```

**íŒŒë¼ë¯¸í„° ì´ë¦„ë“¤ ëª¨ë‘ ì¡°íšŒ**
```java
Enumeration<String> parameterNames = request.getParameterNames();
```
```java
request.getParameterNames().asIterator()
 .forEachRemaining(paramName -> System.out.println(paramName + "=" + request.getParameter(paramName)));
```

**íŒŒë¼ë¯¸í„°ë¥¼ Mapìœ¼ë¡œ ì¡°íšŒ**
```java
Map<String, String[]> parameterMap = request.getParameterMap(); 
```

**ë³µìˆ˜ íŒŒë¼ë¯¸í„° ì¡°íšŒ**
```java
String[] usernames = request.getParameterValues("username"); 
```

**ë³µìˆ˜ íŒŒë¼ë¯¸í„°ì—ì„œ ë‹¨ì¼ íŒŒë¼ë¯¸í„° ì¡°íšŒ**

```http request
http://localhost:8080/request-param?username=sameName&username=sameName2&age=28
```

ì—¬ëŸ¬ ê°’ì´ ë“¤ì–´ì™”ëŠ”ë° `request.getParameter()`ë¥¼ ì‚¬ìš©í•˜ë©´     
`request.getParameterValues()`ì˜ ì²« ë²ˆì§¸ ê°’ì„ ë°˜í™˜í•œë‹¤.

<br/>

<br/>

<br/>


# ğŸ’¡ HTTP ìš”ì²­ ë°ì´í„° - POST HTML Form

![form_post](https://user-images.githubusercontent.com/50267433/126496451-446c2d9a-91b0-438e-af59-8504b5deadf1.PNG)

`POST ë°©ì‹`ì€ **Message Body ì— `Query Parameter` í˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ì‹ì´ë‹¤.**      
ì£¼ë¡œ `íšŒì› ê°€ì…`, `ìƒí’ˆ ì£¼ë¬¸` ë“±ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ë‹¤.

**íŠ¹ì§•**
* `content-type: application/x-www-form-urlencoded`
* ***Message Body ì— Query Parameter í˜•ì‹***ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•œë‹¤. 
  * EX) `username=hello&age=20`

POSTì˜ HTML Formì„ ì „ì†¡í•˜ë©´ *Web Browser* ëŠ” ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ HTTP ë©”ì‹œì§€ë¥¼ ë§Œë“ ë‹¤. (ì›¹ ë¸Œë¼ìš°ì € ê°œë°œì ëª¨ë“œ í™•ì¸)

```url
http://localhost:8080/request-param
```
```http
POST /test HTTP/1.1
Host: localhost:8080
Content-Type: application/x-www-form-urlencoded        

username=hello&age=20
```

* ìš”ì²­ URL: `http://localhost:8080/request-param`
* content-type: `application/x-www-form-urlencoded`

í´ë¼ì´ì–¸íŠ¸(ì›¹ ë¸Œë¼ìš°ì €) ì…ì¥ì—ì„œëŠ” ë‘ ë°©ì‹ì— ì°¨ì´ê°€ ìˆì§€ë§Œ, ì„œë²„ ì…ì¥ì—ì„œëŠ” ë‘˜ì˜ í˜•ì‹ì´ ë™ì¼í•˜ë¯€ë¡œ,    
`request.getParameter()` ëŠ” `GET URL Query Parameter` í˜•ì‹ë„ ì§€ì›í•˜ê³ , `POST HTML Form` í˜•ì‹ë„ ë‘˜ ë‹¤ ì§€ì›í•œë‹¤

<br/>

### **ì°¸ê³ **
* **content-type**ì€ **HTTP ë©”ì‹œì§€ ë°”ë””ì˜ ë°ì´í„° í˜•ì‹ì„ ì§€ì •í•˜ëŠ” ê²ƒ**ì´ë‹¤.
* `GET URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°` í˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•  ë•ŒëŠ” **HTTP ë©”ì‹œì§€ ë°”ë””ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê¸°ì— content-typeì´ ì—†ë‹¤.**
* `POST HTML Form` í˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ë©´ HTTP ë©”ì‹œì§€ ë°”ë””ì— í•´ë‹¹ ë°ì´í„°ë¥¼ í¬í•¨í•´ì„œ ë³´ë‚´ê¸°ì—      
  ë°”ë””ì— í¬í•¨ëœ ë°ì´í„°ê°€ ì–´ë–¤ í˜•ì‹ì¸ì§€ **content-typeì„ ê¼­ ì§€ì •**í•´ì•¼ í•œë‹¤.
* ì´ë ‡ê²Œ html form ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” í˜•ì‹ì„ `application/x-www-form-urlencoded`ë¼ í•œë‹¤.

<br/>

### **ì°¸ê³ 2**

```http request
http://localhost:8080/basic/hello-form.html
```

- `.html` ì™€ ê°™ì´ í™•ì¥ìê°€ ë¶™ëŠ” ê²ƒì€ Spring Controller ë¥¼ ê±°ì¹˜ì§€ ì•Šê³ , **File ì„ ì§ì ‘ ë¶ˆëŸ¬ì˜¤ëŠ” ê²ƒì´ë‹¤.** 


<br/>

<br/>

<br/>

# ğŸ“– HTTP ìš”ì²­ ë°ì´í„° - API ë©”ì‹œì§€ ë°”ë”” - ë‹¨ìˆœ í…ìŠ¤íŠ¸
**`HTTP message body`ì— ë°ì´í„°ë¥¼ ì§ì ‘ ë‹´ì•„ì„œ ìš”ì²­í•˜ëŠ” ë°©ì‹**   
`HTTP API`ì—ì„œ ì£¼ë¡œ ì‚¬ìš©í•˜ë©° `JSON`, `XML`, `TEXT` ë°ì´í„° í˜•ì‹ë“¤ì´ ìˆìœ¼ë©° **ì£¼ë¡œ JSON ì‚¬ìš©í•œë‹¤.**           
ë˜í•œ, `POST`, `PUT`, `PATCH`ì™€ ê°™ì€ ë‹¤ì–‘í•œ `HTTP ë©”ì„œë“œ`ë¥¼ ì´ìš©í•  ìˆ˜ ìˆë‹¤.

ì„œë²„ì—ì„œëŠ” HTTP ë©”ì‹œì§€ ë°”ë””ì˜ ë°ì´í„°ë¥¼ `InputStream`ì„ ì‚¬ìš©í•´ì„œ ì§ì ‘ ì½ì„ ìˆ˜ ìˆë‹¤.

```java
@WebServlet(name = "requestBodyStringServlet", urlPatterns = "/request-body-string")
public class RequestBodyStringServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        ServletInputStream inputStream = request.getInputStream();
        String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);
        System.out.println("messageBody = " + messageBody);
        response.getWriter().write("ok");  
    }
}
```   

### **ì°¸ê³ **
* **inputStream** ì€ `byte ì½”ë“œ`ë¥¼ ë°˜í™˜í•œë‹¤.
* byte ì½”ë“œë¥¼ ìš°ë¦¬ê°€ ì½ì„ ìˆ˜ ìˆëŠ” ë¬¸ì(String)ë¡œ ë³´ë ¤ë©´ `ë¬¸ìí‘œ(Charset)`ë¥¼ ì§€ì •í•´ì£¼ì–´ì•¼ í•œë‹¤. `StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);`
* ì—¬ê¸°ì„œëŠ” UTF_8 Charsetì„ ì§€ì •í•´ì£¼ì—ˆë‹¤.

<br/>

<br/>

<br/>

# ğŸ’¡ HTTP ìš”ì²­ ë°ì´í„° - API ë©”ì‹œì§€ ë°”ë”” - JSON
ì´ë²ˆì—ëŠ” HTTP APIì—ì„œ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” JSON í˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•´ë³´ì.

**JSON í˜•ì‹ ì „ì†¡**
```http   
POST http://localhost:8080/request-body-json   
Host: localhost:8080    
content-type: application/json   

{"username": "hello", "age": 20}   
```
* ê²°ê³¼: messageBody = {"username": "hello", "age": 20}

```java
@Getter @Setter
class HelloData {
    private String username;
    private int age;
}

@WebServlet(name = "requestBodyJsonServlet", urlPatterns = "/request-body-json")
public class RequestBodyJsonServlet extends HttpServlet {

  private ObjectMapper objectMapper = new ObjectMapper();

  @Override
  protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    ServletInputStream inputStream = request.getInputStream();
    String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);
    System.out.println("messageBody = " + messageBody);

    HelloData helloData = objectMapper.readValue(messageBody, HelloData.class);

    System.out.println("helloData.username = " + helloData.getUsername());
    System.out.println("helloData.age = " + helloData.getAge());

    response.getWriter().write("ok");
  }
}
```

### **Jackson, Gson**
* JSON ê²°ê³¼ë¥¼ íŒŒì‹±í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìë°” ê°ì²´ë¡œ ë³€í™˜í•˜ë ¤ë©´ Jackson, Gson ê°™ì€ JSON ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ì•¼í•œë‹¤.
* **ìŠ¤í”„ë§ ë¶€íŠ¸ë¡œ Spring MVCë¥¼ ì„ íƒí•˜ë©´ ê¸°ë³¸ìœ¼ë¡œ Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬(âœ” ObjectMapper)ë¥¼ í•¨ê»˜ ì œê³µí•œë‹¤.**

> ### ObjectMapper
> * ì¬ë°ŒëŠ” ê¸€ì„ ë°œê²¬í–ˆëŠ”ë° `ObjectMapper`ëŠ” Post ìš”ì²­ì‹œ `setter`ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ê°’ì„ ë§¤í•‘í•´ì¤€ë‹¤.
> * ì´ëŠ” ê³§ `@RequestBody`ë‘ë„ ì§ê²°ë˜ëŠ” ê²ƒì´ì—¬ì„œ `Setter` ì‚¬ìš©ì„ ì¤„ì—¬ë³´ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.(GSONì€ ê·¸ëƒ¥ ê°€ëŠ¥)
> * [ì´ë™ìš±ë‹˜ì˜ ë¸”ë¡œê·¸](https://jojoldu.tistory.com/407)

### **HTML Form data Message Body ì™€ InputStream**
* HTML form ë°ì´í„°ë„ `Message Body` ë¥¼ í†µí•´ ì „ì†¡ë˜ë¯€ë¡œ `InputStream`ì„ í†µí•´ ì§ì ‘ ì½ì„ ìˆ˜ ìˆë‹¤.
* í•˜ì§€ë§Œ í¸ë¦¬í•œ íŒŒë¦¬ë¯¸í„° ì¡°íšŒê¸°ëŠ¥(request.getParameter(...))ì„ ì´ë¯¸ ì œê³µí•˜ê¸° ë•Œë¬¸ì— íŒŒë¼ë¯¸í„° ì¡°íšŒ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤.     

<br/>

<br/>

<br/>

# ğŸ’¡ HttpServletResponse ê°œìš”

## âš¡ï¸ HttpServletResponse ì—­í• 
`HttpServletResponse` ëŠ” ì‘ë‹µê³¼ ê´€ë ¨ëœ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆìœ¼ë©°       
`ì‘ë‹µ ë©”ì‹œì§€ë¥¼ ìƒì„±` ë° `í¸ì˜ ê¸°ëŠ¥ì„ ì œê³µ`í•´ì¤€ë‹¤.

**HTTP ì‘ë‹µ ë©”ì‹œì§€ ìƒì„±**
* HTTP ì‘ë‹µì½”ë“œ ì§€ì •
* í—¤ë” ìƒì„±
* ë°”ë”” ìƒì„±

**í¸ì˜ ê¸°ëŠ¥ ì œê³µ**
* Content-Type
* ì¿ í‚¤
* Redirect

<br/>

<br/>

## âš¡ï¸ HttpServletResponse ê¸°ë³¸ ì‚¬ìš©ë²•

```java
@WebServlet(name = "responseHeaderServlet", urlPatterns = "/response-header")
public class ResponseHeaderServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //[status-line]
        response.setStatus(HttpServletResponse.SC_OK); //200
        
        //[response-headers]
        response.setHeader("Content-Type", "text/plain;charset=utf-8");
        response.setHeader("Cache-Control", "no-cache, no-store, mustrevalidate");
        response.setHeader("Pragma", "no-cache");
        response.setHeader("my-header", "hello");
        
        //[message body]
        PrintWriter writer = response.getWriter();
        writer.println("ok");
    }
}
```  
ì‘ë‹µì€ ìš”ì²­ê³¼ ë‹¤ë¥´ê²Œ ë°ì´í„°ë¥¼ ë§¤í•‘í•˜ëŠ” ì‘ì—…ì€ ì—†ê³        
ê°„ë‹¨íˆ `ì‘ë‹µì½”ë“œ` + `í—¤ë” ì„¤ì •` + `ë°”ë””(ë°ì´í„°)`ì˜ ì‘ì—…ë§Œ ìˆ˜í–‰í•˜ë©´ ëœë‹¤.          
ë¬¼ë¡ , `í—¤ë” ì„¤ì •` ì•ˆì— `ìºì‹œ ì„¤ì •`, `ì½˜í…ì¸  íƒ€ì… ì„¤ì •`ì™€ ê°™ì€ ì„¤ì •ë“¤ì„ ë„£ì„ ìˆ˜ ìˆë‹¤.

<br/>

## âš¡ï¸ Header í¸ì˜ ë©”ì„œë“œ
```java
@WebServlet(name = "responseHeaderServlet", urlPatterns = "/response-header")
public class ResponseHeaderServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //[status-line]
        response.setStatus(HttpServletResponse.SC_OK); //200
        
        //[Header í¸ì˜ ë©”ì„œë“œ]
        content(response);
        cookie(response);
        redirect(response);
        
        //[message body]
        PrintWriter writer = response.getWriter();
        writer.println("ok");
    }
}

private void content(HttpServletResponse response) {
    //Content-Type: text/plain;charset=utf-8
    //Content-Length: 2
    
    response.setContentType("text/plain");
    response.setCharacterEncoding("utf-8");
    response.setContentLength(2);                     // ê¸¸ì´ ë§Œí¼ì˜ ë°ì´í„°ë§Œ ì‘ë‹µ, ìƒëµì‹œ ê¸¸ì´ì— ë§ëŠ” ê°’ìœ¼ë¡œ ìë™ ìƒì„±
}

private void cookie(HttpServletResponse response) {
    //Set-Cookie: myCookie=good; Max-Age=600;
    //response.setHeader("Set-Cookie", "myCookie=good; Max-Age=600");
    
    Cookie cookie = new Cookie("myCookie", "good");   // Key-Value ë°ì´í„°  
    cookie.setMaxAge(600);                            // MaxAge 600ì´ˆ
    response.addCookie(cookie);                       // ì¿ í‚¤ë¥¼ ë‹´ëŠ”ë‹¤.   
}

private void redirect(HttpServletResponse response) throws IOException {
    //Status Code 302
    //Location: /basic/hello-form.html
    //response.setStatus(HttpServletResponse.SC_FOUND);         // 302
    //response.setHeader("Location", "/basic/hello-form.html"); // 302 ì‘ë‹µì½”ë“œì™€ ê°™ì´ ì‚¬ìš©ì‹œ ì´ë™ url í‘œí˜„  
    
    response.sendRedirect("/basic/hello-form.html");            // í•´ë‹¹ urlë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¥¼ ì‹œí‚¨ë‹¤.  
}
```
`Header í¸ì˜ ë©”ì„œë“œ`ë¥¼ í†µí•´        
`setHeader()` ë§ê³  ì˜ë¯¸ìˆëŠ” ì´ë¦„ì˜ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

<br/>

<br/>

<br/>

# ğŸ’¡ HTTP ì‘ë‹µ ë°ì´í„°
HTTP ì‘ë‹µ ë©”ì‹œì§€ëŠ” ì£¼ë¡œ ë‹¤ìŒ ë‚´ìš©ì„ ë‹´ì•„ì„œ ì „ë‹¬í•œë‹¤.

* ë‹¨ìˆœ í…ìŠ¤íŠ¸ ì‘ë‹µ(`response.getWriter().println("ok");`)
* HTML ì‘ë‹µ
* HTTP API - MessageBody JSON ì‘ë‹µ

<br/>

## âš¡ï¸ HttpServletResponse - HTML ì‘ë‹µ

```java
@WebServlet(name = "responseHtmlServlet", urlPatterns = "/response-html")
public class ResponseHtmlServlet extends HttpServlet {
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        //Content-Type: text/html;charset=utf-8
        
        response.setContentType("text/html");
        response.setCharacterEncoding("utf-8");
        
        PrintWriter writer = response.getWriter();
        writer.println("<html>");
        writer.println("<body>");
        writer.println(" <div>ì•ˆë…•?</div>");
        writer.println("</body>");
        writer.println("</html>");
    }
}
```
`HTML ì‘ë‹µ`ì€ `Content-Type`ì„ `text/html`ë¡œ ë³´ëƒˆì„ ë•Œ ì ìš©ë  ìˆ˜ ìˆë‹¤.     
ê¸°ì¡´ ë°©ì‹ê³¼ ë™ì¼í•˜ê²Œ `PrintWriter`ì˜ `println` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ì„œ          
`HTML DOM` ìš”ì†Œë“¤ì„ ë„˜ê¸°ë©´ ëœë‹¤.

<br/>

<br/>

<br/>

# ğŸ’¡ HTTP ì‘ë‹µ ë°ì´í„° - API JSON

```java
@WebServlet(name = "responseJsonServlet", urlPatterns = "/response-json")
public class ResponseJsonServlet extends HttpServlet {

  private ObjectMapper objectMapper = new ObjectMapper();
  @Override
  protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
//        Content-Type: application/json
    response.setHeader("content-type", "application/json");
    response.setCharacterEncoding("utf-8");

    HelloData helloData = new HelloData();
    helloData.setUsername("hyunggeol");
    helloData.setAge(28);

    //{"username":"kim","age":20}
    String result = objectMapper.writeValueAsString(helloData);
    response.getWriter().write(result);
  }
}

```
`Jackson ë¼ì´ë¸ŒëŸ¬ë¦¬`ì˜ `ObjectMapper` ì˜ `writeValueAsString`ì´ìš©í•´ì„œ       
ê°ì²´ë¥¼ `JSON í˜•íƒœ`ì˜ Stringìœ¼ë¡œ ë³€í™˜ì„ í•  ìˆ˜ ìˆë‹¤.             
**ì´ë•Œ, `content-type`ì„ `application/json` ë¡œ ì§€ì •í•´ì•¼ í•œë‹¤.**

<br/>

> ### **ì°¸ê³ **   
> `application/json` ì€ ìŠ¤í™ìƒ `utf-8` í˜•ì‹ì„ ì‚¬ìš©í•˜ë„ë¡ ì •ì˜ë˜ì–´ ìˆë‹¤.    
> ê·¸ë˜ì„œ ìŠ¤í™ì—ì„œ `charset=utf-8`ê³¼ ê°™ì€ ì¶”ê°€ íŒŒë¼ë¯¸í„°ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤.
> 
> ë§Œì•½, `application/json;charset=utf-8` ì´ë¼ê³  ì „ë‹¬í•˜ëŠ” ê²ƒì€ ì˜ë¯¸ ì—†ëŠ” íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ê°€í•œ ê²ƒì´ ëœë‹¤.    
> ë”ë¶ˆì–´ `response.getWriter()`ë¥¼ ì‚¬ìš©í•˜ë©´ ì¶”ê°€ íŒŒë¼ë¯¸í„°ë¥¼ ìë™ìœ¼ë¡œ ì¶”ê°€í•´ë²„ë ¤ì„œ ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.         
> ì´ë•ŒëŠ” `response.getOutputStream()`ìœ¼ë¡œ ì¶œë ¥í•˜ë©´ ê·¸ëŸ° ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.    

<br/>

<br/>

<br/>
