# 4. MVC í”„ë ˆì„ì›Œí¬ ë§Œë“¤ê¸°

## ëª©ì°¨
- í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ V1 - Handler Mapping
- í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ V2 - View ë¶„ë¦¬
- í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ V3 - Model ì¶”ê°€, ViewResolver ì¶”ê°€
- í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ V4 - ë‹¨ìˆœí•˜ê³  ì‹¤ìš©ì ìœ¼ë¡œ ë§Œë“¤ê¸° (String ë§Œ ë°˜í™˜)
- í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ V5 - HandlerAdapter ì¶”ê°€

<br/>

<br/>

<br/>

# ğŸ’¡ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ - V1

> FrontController + HandlerMapping ë„ì…

**FrontController ë„ì… ì „**         
![generic-controller-request](https://user-images.githubusercontent.com/50267433/126643365-d51086e7-9c5f-4244-9323-2d2fec1486d9.PNG)

`FrontController`ê°€ ë„ì…ë˜ê¸° ì „ì—ëŠ” ê°ê°ì˜ Controller ì— ê³µí†µëœ ì½”ë“œë“¤ì´ ë§ë‹¤ëŠ” ë¬¸ì œê°€ ìˆë‹¤.       
ì´ë¡œ ì¸í•´, ì¤‘ë³µì´ ë°œìƒí•˜ê³  ì½”ë“œì˜ ë³€ê²½ì´ í•„ìš”í•  ë•Œ ìœ ì§€ë³´ìˆ˜ì„±ì´ ë–¨ì–´ì§„ë‹¤ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤.

**FrontController ë„ì… í›„**          
![front-controller](https://user-images.githubusercontent.com/50267433/126643370-68b2339b-dec3-42d2-8ddf-8ab3da816c9c.png)

ê° ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì•ë‹¨ì— `FrontController`ë¥¼ ë‘ì–´ ê³µí†µ ë¡œì§ì„ `FrontController`ì—ì„œ ì²˜ë¦¬í•˜ë„ë¡ í•œë‹¤.

**FrontController íŒ¨í„´ íŠ¹ì§•**
* ì…êµ¬ë¥¼ í•˜ë‚˜ë¡œ
* `FrontController` í•˜ë‚˜ë¡œ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë°›ìŒ
* `FrontController`ê°€ ìš”ì²­ì— ë§ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì°¾ì•„ì„œ í˜¸ì¶œ
* ê³µí†µ ì²˜ë¦¬ ê°€ëŠ¥ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì„œë¸”ë¦¿ì„ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ

**ìŠ¤í”„ë§ ì›¹ MVCì™€ FrontController**                 
ìŠ¤í”„ë§ ì›¹ MVCì˜ í•µì‹¬ë„ ë°”ë¡œ **FrontController ë‹¤.**                    
ìŠ¤í”„ë§ ì›¹ MVCì˜ **DispatcherServletì´ FrontController íŒ¨í„´**ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆë‹¤.

<br/>

<br/>


## âš¡ï¸ V1 êµ¬ì¡° - Handler Mapping

![v1](https://user-images.githubusercontent.com/50267433/126643978-f306cf6b-04f4-4682-a36a-2d59834d0012.PNG)

í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë„ì…í•œ MVC êµ¬ì¡°ëŠ” ìœ„ì™€ ê°™ë‹¤.               
ëŒ€í‘œì ì¸ ì°¨ì´ì ìœ¼ë¡œëŠ” **ìš”ì²­ URLì„ í†µí•´ ì•Œë§ì€ í•¸ë“¤ëŸ¬(Controller)ë¥¼ ì°¾ì•„ì™€ì„œ ì‹¤í–‰ì„ ì‹œí‚¨ë‹¤.**

ì´ëŸ¬í•œ ê³¼ì •ì—ì„œ **URLê³¼ ë§¤í•‘ëœ Handlerë¥¼ ì €ì¥í•˜ëŠ” ê³µê°„**ì„ `Handler Mapping` ì´ë¼ ë¶€ë¥¸ë‹¤.    
ì¦‰, **í•¸ë“¤ëŸ¬ ë§¤í•‘ìœ¼ë¡œë¶€í„° í•¸ë“¤ëŸ¬ë¥¼ ì¡°íšŒí•´ì„œ ì•Œë§ëŠ” í•¸ë“¤ëŸ¬(Controller)ë¥¼ ì‹¤í–‰í•˜ëŠ” ê³¼ì •ì´ë‹¤.**

<br/>

## âš¡ï¸ FrontController
```java
@WebServlet(name = "frontControllerServletV1", urlPatterns = "/front-controller/v1/*")
public class FrontControllerServletV1 extends HttpServlet {

    private Map<String, ControllerV1> handlerMapping = new HashMap<>();

    public FrontControllerServletV1() {
        handlerMapping.put("/front-controller/v1/members/new-form", new MemberFormControllerV1());
        handlerMapping.put("/front-controller/v1/members/save", new MemberSaveControllerV1());
        handlerMapping.put("/front-controller/v1/members", new MemberListControllerV1());
    }

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        System.out.println("FrontControllerServletV1.service");

        String requestURI = request.getRequestURI();

        ControllerV1 controller = handlerMapping.get(requestURI);

        if (controller == null) {
            response.setStatus(HttpServletResponse.SC_NOT_FOUND);
            return;
        }

        controller.process(request, response);
    }
}
```   
`Map<String, ControllerV1> controllerMap`ì€ ë‹¤ì–‘í•œ Controller ê°ì²´ë¥¼ ì €ì¥í•˜ëŠ” **Handler Mapping**ì´ë‹¤.

**urlPatterns**
* `urlPatterns = "/front-controller/v1/*"`
* íŒ¨í„´ ë§¤ì¹­ìœ¼ë¡œ `/front-controller/v1` ë¥¼ í¬í•¨í•œ ëª¨ë“  í•˜ìœ„ ìš”ì²­ì„ ì´ ì„œë¸”ë¦¿ì—ì„œ ì²˜ë¦¬í•œë‹¤.
* ì˜ˆ) `/front-controller/v1` , `/front-controller/v1/a` , `/front-controller/v1/a/b`

**controllerMap**
* **key :** ë§¤í•‘ URL
* **value :** í˜¸ì¶œë  ì»¨íŠ¸ë¡¤ëŸ¬

### service()
í•¸ë“¤ëŸ¬ ë§¤í•‘ì—ì„œ URIë¥¼ ì¡°íšŒí•´ì„œ ì‹¤ì œ í˜¸ì¶œí•  ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ `controllerMap`ì—ì„œ ì°¾ëŠ”ë‹¤.                    
ë§Œì•½ ì—†ë‹¤ë©´ **404(SC_NOT_FOUND) ìƒíƒœ ì½”ë“œë¥¼ ë°˜í™˜í•œë‹¤.**                     
ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì°¾ì•˜ë‹¤ë©´ `controller.process(request, response);`ì™€ ê°™ì´ í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì‹¤í–‰í•œë‹¤.

<br/>

<br/>

## âš¡ï¸ Controller ì¸í„°í˜ì´ìŠ¤
```java
public interface ControllerV1 {
    void process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException;
}
```   
FrontControllerì—ì„œ **ë‹¤ì–‘í•œ Controllerë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ê³µí†µ ê·œì•½ì¸ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë„ì…í•œë‹¤.**                     
ì¦‰, FrontControllerì—ì„œ ì¸í„°í˜ì´ìŠ¤ ì°¸ì¡°ë¥¼ í†µí•´ êµ¬í˜„ê³¼ ê´€ê³„ì—†ì´ ë¡œì§ì˜ ì¼ê´€ì„±ì„ ê°€ì§€ê²Œë” ë§Œë“¤ì—ˆë‹¤.

<br/>


## âš¡ï¸ Controller êµ¬í˜„ì²´ - íšŒì› ë“±ë¡ í¼
```java
public class MemberFormControllerV1 implements ControllerV1 {
    @Override
    public void process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String viewPath = "/WEB-INF/views/new-form.jsp";
        RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
        dispatcher.forward(request, response);
    }
}
```

<br/>


## âš¡ï¸ Controller êµ¬í˜„ì²´ - íšŒì› ì €ì¥
```java
public class MemberSaveControllerV1 implements ControllerV1 {
     private MemberRepository memberRepository = MemberRepository.getInstance();
     
     @Override
     public void process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
         // ë©¤ë²„ ì €ì¥ 
         String username = request.getParameter("username");
         int age = Integer.parseInt(request.getParameter("age"));
         Member member = new Member(username, age);
         memberRepository.save(member);
         
         // Modelì— ë°ì´í„° ë³´ê´€   
         request.setAttribute("member", member);
         
         // Viewë¡œ ë°ì´í„° íë¦„ ì´ë™   
         String viewPath = "/WEB-INF/views/save-result.jsp";
         RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
         dispatcher.forward(request, response);
    }
}
```

<br/>


## âš¡ï¸ Controller êµ¬í˜„ì²´ - íšŒì› ëª©ë¡ ì¡°íšŒ
```java
public class MemberListControllerV1 implements ControllerV1 {
    private MemberRepository memberRepository = MemberRepository.getInstance();
    @Override
    public void process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // ëª©ë¡ ì¡°íšŒ  
        List<Member> members = memberRepository.findAll();
        
        // Modelì— ë°ì´í„° ë³´ê´€    
        request.setAttribute("members", members);
        
        // Viewë¡œ ë°ì´í„° íë¦„ ì´ë™   
        String viewPath = "/WEB-INF/views/members.jsp";
        RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
        dispatcher.forward(request, response);
    }
}
```

<br/>

<br/>

<br/>

# ğŸ’¡ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ - V2

> View ë¶„ë¦¬

## âš¡ï¸ V2 êµ¬ì¡°
![v2](https://user-images.githubusercontent.com/50267433/126652138-455c048f-5377-4c3d-ba19-fb35ab93a5e9.PNG)

V2 êµ¬ì¡°ëŠ” V1êµ¬ì¡°ì—ì„œ **View ì™€ ê´€ë ¨ëœ ë¡œì§ì„ View ê°ì²´ë¡œ ë¶„ë¦¬ì‹œí‚¨ êµ¬ì¡°ë‹¤.**

í™”ë©´ì„ render í•˜ëŠ” ê°ì²´ì¸ MyView ë¡œ ë¶„ë¦¬í•˜ì˜€ë‹¤.

**ëª¨ë“  Controllerì—ì„œ ì •ì˜ëœ View ë¡œì§**
```java
String viewPath = "/WEB-INF/views/new-form.jsp";
RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
dispatcher.forward(request, response);
```   

ëª¨ë“  Controllerë“¤ì€ ë¡œì§ì„ ìˆ˜í–‰í•œ í›„ íŠ¹ì • Viewë¡œ íë¦„ì„ ì´ë™í•˜ê¸° ìœ„í•´ ìœ„ì™€ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤.          
ê·¸ëŸ¬ë‚˜ ìœ„ì™€ ê°™ì€ ì½”ë“œê°€ ëª¨ë“  Controllerì— ì¡´ì¬í•˜ê¸°ì— ì¤‘ë³µì´ ë°œìƒí•˜ê³  ì´ë¡œì¸í•´ ìœ ì§€ë³´ìˆ˜ì— ì–´ë ¤ì›€ì´ ìƒê²¼ë‹¤.     
(ê²½ë¡œë‚˜ í˜•ì‹ì´ ë°”ë€ë‹¤ë©´ ëª¨ë“  Controllerì˜ ì½”ë“œë¥¼ ì¼ì¼íˆ ìˆ˜ì •í•´ì¤˜ì•¼ í•œë‹¤ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤.)

ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´, **View ê´€ë ¨ ë¡œì§ì„ `ë³„ë„ì˜ ê°ì²´`ë¡œ ë¶„ë¦¬í•˜ëŠ” ë°©ë²•ì„ ê³ ì•ˆí•´ëƒˆê³  ì´ë¥¼ í™œìš©í•œê²Œ V2ì´ë‹¤.**

<br/>

<br/>

## âš¡ï¸ FrontController - View ë¶„ë¦¬
```java
@WebServlet(name = "frontControllerServletV2", urlPatterns = "/front-controller/v2/*")
public class FrontControllerServletV2 extends HttpServlet {

    private Map<String, ControllerV2> handlerMapping = new HashMap<>();

    public FrontControllerServletV2() {
        handlerMapping.put("/front-controller/v2/members/new-form", new MemberFormControllerV2());
        handlerMapping.put("/front-controller/v2/members/save", new MemberSaveControllerV2());
        handlerMapping.put("/front-controller/v2/members", new MemberListControllerV2());
    }

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        System.out.println("FrontControllerServletV2.service");

        String requestURI = request.getRequestURI();

        ControllerV2 controller = handlerMapping.get(requestURI);

        if (controller == null) {
            response.setStatus(HttpServletResponse.SC_NOT_FOUND);
            return;
        }

        MyView view = controller.process(request, response);
        view.render(request, response);
    }
}
```    
`FrontController`ëŠ” V1ê³¼ ë¹„êµí–ˆì„ ë•Œ ê·¸ë¦¬ í¬ê²Œ ë³€í•˜ì§€ëŠ” ì•Šì•˜ì§€ë§Œ           
`view.render(request, response);`ë¥¼ í†µí•´ ë°ì´í„° íë¦„ì„ ì´ë™ì‹œí‚¤ê³  ìˆë‹¤.       
ì¦‰, `MyView view` ê°ì²´ë¥¼ í™œìš©í•˜ì—¬ ì¤‘ë³µëœ ì½”ë“œë¥¼ ì¤„ì´ê³  ì—­í• ì„ ìœ„ì„í•˜ê¸°ë„ í–ˆë‹¤.

<br/>

<br/>

## âš¡ï¸ View í´ë˜ìŠ¤ - View ê´€ë ¨ ë¡œì§ ë¶„ë¦¬
```java
public class MyView {
      
    private String viewPath;   
      
    public MyView(String viewPath) {
        this.viewPath = viewPath;
    }
      
    public void render(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
        dispatcher.forward(request, response);
    }
}
```
`MyView`í´ë˜ìŠ¤ëŠ” `View`ì™€ ê´€ë ¨ëœ ë¡œì§ë§Œì„ ìˆ˜í–‰í•˜ëŠ” ê°ì²´ë‹¤.                   
ì €ì¥í•˜ê³  ìˆëŠ” ê²½ë¡œë¥¼ í†µí•´ ë°ì´í„° íë¦„ì„ ë„˜ê¸°ëŠ” ì‘ì—…ì„ í•˜ê³  ìˆë‹¤.              
ì—¬ê¸°ì„œëŠ” êµ¬í˜„ì´ ë˜ì–´ìˆì§€ ì•Šì§€ë§Œ, ë•Œì— ë”°ë¼ **`interface` ë¥¼ ì´ìš©í•˜ì—¬ `prefix`ì™€ `suffix`ë¥¼ ë¶„ë¦¬í•˜ì—¬ ê³µí†µìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.**

<br/>

<br/>

## âš¡ï¸ Controller ì¸í„°í˜ì´ìŠ¤
```java
public interface ControllerV2 {
    MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException;
}
```
**V1ê³¼ ë‹¬ë¦¬, `MyView`ë¥¼ ë¦¬í„´í•˜ë„ë¡ ì •ì˜ë˜ì–´ìˆë‹¤.**

<br/>


## âš¡ï¸ Controller êµ¬í˜„ì²´ - íšŒì› ë“±ë¡ í¼
```java
public class MemberFormControllerV2 implements ControllerV2 {
    @Override
    public MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        return new MyView("/WEB-INF/views/new-form.jsp");
    }
}
```  
`View`ì™€ ê´€ë ¨ëœ ë¡œì§ì€ ì´ë¯¸ `MyView`ì—ì„œ ì²˜ë¦¬í•˜ë¯€ë¡œ ê²½ë¡œë¥¼ ë„˜ê²¨ì£¼ì–´ ë°˜í™˜í•˜ëŠ” í˜•ì‹ìœ¼ë¡œ ì½”ë“œë¥¼ êµ¬ì„±í–ˆë‹¤.

<br/>


## âš¡ï¸ Controller êµ¬í˜„ì²´ - íšŒì› ì €ì¥

```java
public class MemberSaveControllerV2 implements ControllerV2 {
    
    private MemberRepository memberRepository = MemberRepository.getInstance();
    
    @Override
    public MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // ë°ì´í„° ì €ì¥
        String username = request.getParameter("username");
        int age = Integer.parseInt(request.getParameter("age"));
        Member member = new Member(username, age);
        memberRepository.save(member);
        
        // Modelì— ë°ì´í„° ë³´ê´€  
        request.setAttribute("member", member);
        
        // View ê²½ë¡œë¥¼ ì €ì¥í•˜ëŠ” MyView ë°˜í™˜ 
        return new MyView("/WEB-INF/views/save-result.jsp");
    }
}
```

<br/>


## âš¡ï¸ Controller êµ¬í˜„ì²´ - íšŒì› ëª©ë¡ ì¡°íšŒ

```java
public class MemberListControllerV2 implements ControllerV2 {
    
    private MemberRepository memberRepository = MemberRepository.getInstance();
    
    @Override
    public MyView process(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // ë°ì´í„° ì¡°íšŒ 
        List<Member> members = memberRepository.findAll();
        
        // Modelì— ë°ì´í„° ë³´ê´€ 
        request.setAttribute("members", members);
        
        // View ê²½ë¡œë¥¼ ì €ì¥í•˜ëŠ” MyView ë°˜í™˜  
        return new MyView("/WEB-INF/views/members.jsp");
    }
}
```

<br/>

<br/>

<br/>

# ğŸ’¡í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ - V3
> **Model ì¶”ê°€, ViewResolver ì¶”ê°€**               
> HttpServletRequest/HttpServletResponse ì„œë¸”ë¦¿ ì¢…ì†ì„± ì½”ë“œ ì œê±°

### **ì„œë¸”ë¦¿ ì¢…ì†ì„± ì œê±° - Model ì¶”ê°€, HttpServletRequest/HttpServletResponse ì œê±°**
ì‚¬ì‹¤, ControllerëŠ” `HttpServletRequest`, `HttpServletResponse`ì€ í•„ìš”í•˜ì§€ ì•Šë‹¤.                         
**ControllerëŠ” request parameter ì •ë³´ë§Œ í•„ìš”**í•˜ê¸°ì— `key`ì™€ `value` êµ¬ì¡°ì¸ `Map ê°ì²´`ë§Œ ë„˜ê²¨ì£¼ë©´ ëœë‹¤.                          
ê·¸ë¦¬ê³  **requestê°€ ì—†ê¸°ì— ë³„ë„ì˜ Model ê°ì²´**ë¥¼ ë§Œë“¤ì–´ì„œ ë°˜í™˜í•˜ëŠ” êµ¬ì¡°ë¡œ ê°€ì§€ë„ë¡ í•´ì•¼í•œë‹¤.

ì¦‰, **Controllerê°€ ì„œë¸”ë¦¿ ê¸°ìˆ ì„ ëª°ë¼ë„ ë™ì‘**í•  ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ í•˜ì—¬, í™•ì¥ê³¼ í…ŒìŠ¤íŠ¸ì— ìœ ì—°í•œ êµ¬ì¡°ë¥¼ ê°€ì§€ë„ë¡ í–ˆë‹¤.

### **ë·° ì´ë¦„ ì¤‘ë³µ ì œê±° - ViewResolver ì¶”ê°€**
View ê²½ë¡œë¥¼ ë³´ë©´ `/WEB-INF/views/`, `.jsp`ì™€ ê°™ì€ ì¤‘ë³µëœ ì´ë¦„ì´ ìˆë‹¤. (ë¬¼ë¦¬ ìœ„ì¹˜ì˜ ì´ë¦„)           
ì´ë“¤ì„ ì§ì ‘ ì…ë ¥í•˜ì§€ ì•Šê³  Controller ì—ì„œ ë‹¨ìˆœíˆ **ë·°ì˜ ë…¼ë¦¬ ì´ë¦„**ì„ ë°˜í™˜í•˜ë„ë¡ í•˜ê³ ,         
**ì‹¤ì œ ë¬¼ë¦¬ ìœ„ì¹˜ì˜ ì´ë¦„ì€ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì²˜ë¦¬í•˜ë„ë¡ ë‹¨ìˆœí™” í•˜ì.**      
ì´ë ‡ê²Œ í•´ë‘ë©´ í–¥í›„ ë·°ì˜ í´ë” ìœ„ì¹˜ê°€ í•¨ê»˜ ì´ë™í•´ë„ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë§Œ ê³ ì¹˜ë©´ ëœë‹¤.

**ë³€ê²½ì˜ ì§€ì ì„ í•˜ë‚˜ë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤!!!**

- `/WEB-INF/views/new-form.jsp` -> **new-form** 
- `/WEB-INF/views/save-result.jsp` -> **save-result** 
- `/WEB-INF/views/members.jsp` -> **members**

<br/>

## **ì •ë¦¬**       
`HttpServletRequest`, `HttpServletResponse` ì œê±°ë¥¼ í•œë‹¤.            
`Controller` ì—ëŠ” `Map<String, String>` íƒ€ì…ì˜ íŒŒë¼ë¯¸í„° ë°ì´í„°ë§Œ ë„˜ê²¨ì¤€ë‹¤.                
`Controller` ëŠ” íŒŒë¼ë¯¸í„° ë°ì´í„°ë¥¼ ì´ìš©í•˜ì—¬ ë¹„ì¦ˆë‹ˆìŠ¤ë¡œì§ì„ ìˆ˜í–‰í•˜ê³               
ê²°ê³¼ê°’ì„ `ModelView ê°ì²´`ì— `Map<String, Object>`í˜•ì‹ìœ¼ë¡œ `View ê²½ë¡œ`ì™€ í•¨ê»˜ ì €ì¥í•œ í›„ ë°˜í™˜í•œë‹¤.

ì´ê±´ ë‚˜ë§Œì„ ìœ„í•œ ì •ë¦¬ì¸ë° `ModelView ê°ì²´`ì—ì„œ `Map<String, Object>`ë¥¼ ìƒì„±í•˜ê¸°ì—    
ì´ë¥¼ `getModel().put(ë°ì´í„°)`ë¥¼ ì´ìš©í•´ì„œ ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” êµ¬ì¡°ì´ë‹¤.

<br/>

<br/>

## âš¡ï¸ V3 êµ¬ì¡°

![v3](https://user-images.githubusercontent.com/50267433/126672741-b1935d82-b903-47b9-8fab-5f796d63bb6f.PNG)

ê¸°ì¡´ì—ëŠ” `request.setAttribute()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ë·°ì— ì „ë‹¬í–ˆë‹¤.(Model ì—­í• )                
ê·¸ëŸ¬ë‚˜ `HttpServletRequest`ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ê¸°ëŠ¥ì´ ë„ˆë¬´ ë§ê³  í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸° ì–´ë µë‹¤.                        
ì„œë¸”ë¦¿ ì¢…ì†ì„± ì œê±°ë¥¼ ìœ„í•´ **Modelì„ ë§Œë“¤ê³ , View ì´ë¦„ê¹Œì§€ ì „ë‹¬í•˜ëŠ” ê°ì²´ `ModelView`ë¥¼ ë§Œë“¤ì–´ë³´ì.**

ì˜ˆì œë¥¼ ìœ„í•œ `ModelView` ê°ì²´ëŠ” ë‹¤ë¥¸ ë²„ì „ì—ì„œë„ ì‚¬ìš©í•˜ë¯€ë¡œ íŒ¨í‚¤ì§€ë¥¼ `frontController`ì— ë‘”ë‹¤.

<br/>

## âš¡ï¸ FrontController
```java
@WebServlet(name = "frontControllerServletV3", urlPatterns = "/front-controller/v3/*")
public class FrontControllerServletV3 extends HttpServlet {

  private Map<String, ControllerV3> handlerMapping = new HashMap<>();

  public FrontControllerServletV3() {
    handlerMapping.put("/front-controller/v3/members/new-form", new MemberFormControllerV3());
    handlerMapping.put("/front-controller/v3/members/save", new MemberSaveControllerV3());
    handlerMapping.put("/front-controller/v3/members", new MemberListControllerV3());
  }

  @Override
  protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    System.out.println("FrontControllerServletV3.service");

    String requestURI = request.getRequestURI();

    ControllerV3 controller = handlerMapping.get(requestURI);

    if (controller == null) {
      response.setStatus(HttpServletResponse.SC_NOT_FOUND);
      return;
    }

    // paramMap
    Map<String, String> paramMap = createParamMap(request);
    ModelView modelView = controller.process(paramMap);

    String viewName = modelView.getViewName();// ë…¼ë¦¬ì´ë¦„
    MyView view = viewResolver(viewName);

    view.render(modelView.getModel(), request, response);
  }

  private static MyView viewResolver(String viewName) {
    return new MyView("/WEB-INF/views/" + viewName + ".jsp"); // ë¬¼ë¦¬ì´ë¦„
  }

  private static Map<String, String> createParamMap(HttpServletRequest request) {
    Map<String, String> paramMap = new HashMap<>();
    request.getParameterNames().asIterator().forEachRemaining(paramName ->
            paramMap.put(paramName, request.getParameter(paramName)));
    return paramMap;
  }
}
```     

**íŒŒë¼ë¯¸í„° ë°ì´í„° ì¶”ì¶œ**
* `createParamMap()`
* FrontControllerì—ì„œëŠ” `HttpServletRequest request`ë¥¼ í™œìš©í•´                 
  `Map<String, String> paramMap`ì— íŒŒë¼ë¯¸í„° ì´ë¦„ê³¼ ê·¸ ê°’ì„ ë§¤í•‘í•˜ì—¬ ì €ì¥ì‹œí‚¤ê³  ìˆë‹¤.
* ìƒì„±ëœ `paramMap`ì„ controllerì— ì£¼ì…ì‹œì¼œ Model ê°’ê³¼ ViewNameì„ ê°€ì§„ `ModelView`ë¥¼ ë°˜í™˜í•˜ë„ë¡ í•œë‹¤
* ì°¸ê³ ë¡œ, ì´ë•Œ ë°˜í™˜ëœ **`ViewName`ì€ ë‹¨ìˆœí•œ ê²½ë¡œë§Œì„ ë‚˜íƒ€ë‚¸ë‹¤.(prefixì™€ suffixë¥¼ ê°€ì§€ ì•Šì€ ê²½ë¡œ)**

**ViewResolver**
* `MyView view = viewResolver(viewName)`
* ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë°˜í™˜í•œ ë…¼ë¦¬ ë·° ì´ë¦„ì„ ì‹¤ì œ ë¬¼ë¦¬ ë·° ê²½ë¡œë¡œ ë³€ê²½í•˜ê³  ì‹¤ì œ ë¬¼ë¦¬ ê²½ë¡œê°€ ìˆëŠ” MyView ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.
* ë…¼ë¦¬ ë·° ì´ë¦„: `members`
* ë¬¼ë¦¬ ë·° ê²½ë¡œ: `/WEB-INF/views/members.jsp`

**ë Œë”ë§ ì‘ì—…**
* `view.render(mv.getModel(), request, response)`
* ë·° ê°ì²´(MyView)ë¥¼ í†µí•´ì„œ HTML í™”ë©´ì„ ë Œë”ë§ í•œë‹¤.
* ë·° ê°ì²´(MyView)ì˜ render() ëŠ” Model ì •ë³´ë„ í•¨ê»˜ ë°›ëŠ”ë‹¤.
* Model ì •ë³´ëŠ” ë‚´ë¶€ì—ì„œ `request.setAttribute()`ë¡œ ë‹´ì•„ë‘”ë‹¤.

<br/>

## âš¡ï¸ MyView
```java
public class MyView {
    private String viewPath;

    public MyView(String viewPath) {
        this.viewPath = viewPath;
    }

    public void render(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        RequestDispatcher requestDispatcher = request.getRequestDispatcher(viewPath);
        requestDispatcher.forward(request, response);
    }

    public void render(Map<String, Object> model, HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        modelToRequestAttribute(model, request);
        RequestDispatcher requestDispatcher = request.getRequestDispatcher(viewPath);
        requestDispatcher.forward(request, response);
    }

    private void modelToRequestAttribute(Map<String, Object> model, HttpServletRequest request) {
      model.forEach(request::setAttribute);
    }
}
```
MyViewëŠ” ê¸°ì¡´ ë©”ì„œë“œì™€ ë”ë¶ˆì–´ **ëª¨ë¸ì„ ì €ì¥í•˜ëŠ” ê¸°ëŠ¥ì„ ê°€ì§€ëŠ” `render()`ë¥¼ êµ¬í˜„í•´ì¤˜ì•¼ í•œë‹¤.**          
MyViewëŠ” `request.setAttribute()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ë·°ë¡œ ë°ì´í„° íë¦„ì„ ì´ë™ì‹œí‚¨ë‹¤.

<br/>

## âš¡ï¸ ModelView
`ModelView`ëŠ” `Viewì˜ ì´ë¦„`ê³¼ ë·°ë¥¼ ë Œë”ë§í•  ë•Œ í•„ìš”í•œ `model ê°ì²´`ë¥¼ ê°€ì§€ê³  ìˆë‹¤.

```java
public class ModelView {

    private String viewName;
    private Map<String, Object> model = new HashMap<>();

    public ModelView(String viewName) {
        this.viewName = viewName;
    }

    public String getViewName() {
        return viewName;
    }

    public void setViewName(String viewName) {
        this.viewName = viewName;
    }

    public Map<String, Object> getModel() {
        return model;
    }

    public void setModel(Map<String, Object> model) {
        this.model = model;
    }
}
```   
Modelì€ ë‹¨ìˆœíˆ Mapìœ¼ë¡œ ë˜ì–´ ìˆìœ¼ë¯€ë¡œ **Controllerë¡œë¶€í„° ë·°ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ key, valueë¡œ ë°›ëŠ”ë‹¤.**

<br/>

<br/>

## âš¡ï¸ Controller ì¸í„°í˜ì´ìŠ¤
```java
public interface ControllerV3 {
    ModelView process(Map<String, String> paramMap);
}
```
`HttpServletRequest`ê°€ ì œê³µí•˜ëŠ” **íŒŒë¼ë¯¸í„°ëŠ” FrontControllerê°€ paramMapì— ë‹´ì•„ì„œ í˜¸ì¶œí•´ì£¼ë©´ ëœë‹¤.**      
**ì‘ë‹µ ê²°ê³¼ë¡œ ë·° ì´ë¦„ê³¼ ë·°ì— ì „ë‹¬í•  Model ë°ì´í„°ë¥¼ í¬í•¨í•˜ëŠ” ModelView ê°ì²´ë¥¼ ë°˜í™˜í•˜ë©´ ëœë‹¤.**

<br/>

## âš¡ï¸ Controller êµ¬í˜„ì²´ - íšŒì› ë“±ë¡ í¼
```java
public class MemberFormControllerV3 implements ControllerV3 {

    @Override
    public ModelView process(Map<String, String> paramMap) {
        return new ModelView("new-form");
    }

}
```
ì´ì „ê³¼ ë‹¤ë¥´ê²Œ prefix, suffixë¥¼ ì œì™¸í•œ viewì˜ ë…¼ë¦¬ì ì¸ ì´ë¦„ë§Œ ì €ì¥í•œë‹¤.    
ì‹¤ì œ ë¬¼ë¦¬ì ì¸ ì´ë¦„ì€ Front Controller ì—ì„œ ì²˜ë¦¬í•˜ë„ë¡

<br/>

## âš¡ï¸ Controller êµ¬í˜„ì²´ - íšŒì› ì €ì¥
```java
public class MemberSaveControllerV3 implements ControllerV3 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public ModelView process(Map<String, String> paramMap) {
        String username = paramMap.get("username");
        int age = Integer.parseInt(paramMap.get("age"));

        Member member = new Member(username, age);
        memberRepository.save(member);

        ModelView modelView = new ModelView("save-result");
        modelView.getModel().put("member", member);
        return modelView;
    }
}
```   

* `paramMap.get("username");`    
  íŒŒë¼ë¯¸í„° ì •ë³´ëŠ” mapì— ë‹´ê²¨ìˆë‹¤.         
  mapì—ì„œ í•„ìš”í•œ ìš”ì²­ íŒŒë¼ë¯¸í„°ë¥¼ ì¡°íšŒí•˜ë©´ ëœë‹¤.
* `mv.getModel().put("member", member);`   
  ëª¨ë¸ì€ ë‹¨ìˆœí•œ mapì´ë¯€ë¡œ ëª¨ë¸ì— ë·°ì—ì„œ í•„ìš”í•œ member ê°ì²´ë¥¼ ë‹´ê³  ë°˜í™˜í•œë‹¤.

<br/>

## âš¡ï¸ Controller êµ¬í˜„ì²´ - íšŒì› ëª©ë¡
```java
    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public ModelView process(Map<String, String> paramMap) {
        List<Member> members = memberRepository.findAll();
        ModelView modelView = new ModelView("members");
        modelView.getModel().put("members", members);
        return modelView;
    }
```

<br/>

<br/>

<br/>

# ğŸ’¡ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ - V4
> ë‹¨ìˆœí•˜ê³  ì‹¤ìš©ì ì¸ ì»¨íŠ¸ë¡¤ëŸ¬

V3 ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” **ì„œë¸”ë¦¿ ì¢…ì†ì„±ì„ ì œê±°(HttpServletRequest/HttpServletResponse ì œê±°)** í•˜ê³ ,   
**ë·° ê²½ë¡œì˜ ì¤‘ë³µì„ ì œê±°(viewResolver ì¶”ê°€)** í•˜ëŠ” ë“± ì˜ ì„¤ê³„ëœ ì»¨íŠ¸ë¡¤ëŸ¬ë‹¤.             

ê·¸ëŸ¬ë‚˜ **í•­ìƒ ModelView ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ë°˜í™˜í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì¡°ê¸ˆ ê»„ë„ëŸ½ë‹¤.**

ì¢‹ì€ í”„ë ˆì„ì›Œí¬ëŠ” ì•„í‚¤í…ì²˜ë„ ì¤‘ìš”í•˜ì§€ë§Œ, **ê°œë°œìê°€ ë‹¨ìˆœí•˜ê³  í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í• ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.**            
ì´ë²ˆì—ëŠ” v3ë¥¼ ì¡°ê¸ˆ ë³€í˜•í•´ì„œ ë§¤ìš° í¸ë¦¬í•˜ê²Œ ê°œë°œí•  ìˆ˜ ìˆëŠ” v4 ë²„ì „ì„ ê°œë°œí•´ë³´ì.

<br/>

## âš¡ï¸ V4 êµ¬ì¡°

![v4](https://user-images.githubusercontent.com/50267433/126820122-89afe9fd-d26e-48bb-9248-afab6c1bae07.PNG)

ê¸°ì¡´ V3ì™€ ë§¤ìš° ë¹„ìŠ·í•œ êµ¬ì¡°ì´ì§€ë§Œ, `Controller` ì—ê²Œ íŒŒë¼ë¯¸í„° ì •ë³´ëŠ” ë¬¼ë¡  **Model ì •ë³´ê¹Œì§€ ë„˜ê¸´ë‹¤.**           
`Controller`ì—ì„œëŠ” **Modelì— ì •ë³´**ë¥¼ ë„£ê¸°ë§Œ í•´ë„ ê°ì²´ì´ë¯€ë¡œ ë°ì´í„°ê°€ ë°˜ì˜ì´ ë  ê²ƒì´ê³        
ë°˜í™˜í•˜ëŠ” ê°’ìœ¼ë¡œëŠ” **ë‹¨ìˆœ String íƒ€ì…ì˜ View ê²½ë¡œ**ë§Œ ë„˜ê²¨ì£¼ë©´ ë  ê²ƒì´ë‹¤.

<br/>

## âš¡ï¸ FrontController

```java
@WebServlet(name = "frontControllerServletV4", urlPatterns = "/front-controller/v4/*")
public class FrontControllerServletV4 extends HttpServlet {

  private Map<String, ControllerV4> handlerMapping = new HashMap<>();

  public FrontControllerServletV4() {
    handlerMapping.put("/front-controller/v4/members/new-form", new MemberFormControllerV4());
    handlerMapping.put("/front-controller/v4/members/save", new MemberSaveControllerV4());
    handlerMapping.put("/front-controller/v4/members", new MemberListControllerV4());
  }

  @Override
  protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    System.out.println("FrontControllerServletV4.service");

    String requestURI = request.getRequestURI();

    ControllerV4 controller = handlerMapping.get(requestURI);

    if (controller == null) {
      response.setStatus(HttpServletResponse.SC_NOT_FOUND);
      return;
    }

    // paramMap
    Map<String, String> paramMap = createParamMap(request);
    // model ì¶”ê°€
    Map<String, Object> model = new HashMap<>();

    String viewName = controller.process(paramMap, model);
    MyView view = viewResolver(viewName);

    view.render(model, request, response);
  }

  private static MyView viewResolver(String viewName) {
    return new MyView("/WEB-INF/views/" + viewName + ".jsp"); // ë¬¼ë¦¬ì´ë¦„
  }

  private static Map<String, String> createParamMap(HttpServletRequest request) {
    Map<String, String> paramMap = new HashMap<>();
    request.getParameterNames().asIterator().forEachRemaining(paramName ->
            paramMap.put(paramName, request.getParameter(paramName)));
    return paramMap;
  }
}
```
FrontController ì—ì„œ `Map<String, Object> model = new HashMap<>();`ì„ í†µí•´ ëª¨ë¸ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.         
ê¸°ì¡´ê³¼ ë‹¤ë¥´ê²Œ Controllerì—ê²Œ ëª¨ë¸ì„ ë„˜ê²¨ì£¼ì–´ **Controllerì—ì„œ Modelì— ê°’ì„ ë„£ëŠ” ë°©ì‹**ìœ¼ë¡œ ì·¨í•œë‹¤.              
ë˜í•œ, ControllerëŠ” View ê²½ë¡œë§Œ ë°˜í™˜í•˜ë©´ ë˜ë¯€ë¡œ ì´ë¥¼ ì´ìš©í•´ **ViewResolverë„ ì†ì‰½ê²Œ í˜¸ì¶œ ê°€ëŠ¥**í•˜ê²Œ í•œë‹¤.

<br/>

<br/>

## âš¡ï¸ Controller êµ¬í˜„ì²´ - íšŒì› ë“±ë¡ í¼
```java
public class MemberFormControllerV4 implements ControllerV4 {

    @Override
    public String process(Map<String, String> paramMap, Map<String, Object> model) {
        return "new-form";
    }
}
```

<br/>

## âš¡ï¸ Controller êµ¬í˜„ì²´ - íšŒì› ì €ì¥
```java
public class MemberSaveControllerV4 implements ControllerV4 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public String process(Map<String, String> paramMap, Map<String, Object> model) {
        String username = paramMap.get("username");
        int age = Integer.parseInt(paramMap.get("age"));

        Member member = new Member(username, age);
        memberRepository.save(member);
        model.put("member", member);
        return "save-result";
    }
}
```

<br/>

## âš¡ï¸ Controller êµ¬í˜„ì²´ - íšŒì› ëª©ë¡
```java
public class MemberListControllerV4 implements ControllerV4 {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    public String process(Map<String, String> paramMap, Map<String, Object> model) {
        List<Member> members = memberRepository.findAll();
        model.put("members", members);
        return "members";
    }
}
```

<br/>

## ì •ë¦¬
V4 ë²„ì „ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ë§¤ìš° ë‹¨ìˆœí•˜ê³  ì‹¤ìš©ì ì´ë‹¤.     
ê¸°ì¡´ êµ¬ì¡°ì—ì„œ ëª¨ë¸ì„ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê¸°ê³ , ë·°ì˜ ë…¼ë¦¬ ì´ë¦„ì„ ë°˜í™˜í•œë‹¤ëŠ” ì‘ì€ ì•„ì´ë””ì–´ë¥¼ ì ìš©í–ˆì„ ë¿ì¸ë°,            
ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ êµ¬í˜„í•˜ëŠ” ê°œë°œì ì…ì¥ì—ì„œ ë³´ë©´ ì´ì œ êµ°ë”ë”ê¸° ì—†ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

<br/>

<br/>

<br/>

# ğŸ’¡ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ - V5


```java
public interface ControllerV3 {
    ModelView process(Map<String, String> paramMap);
}
```
```java
public interface ControllerV4 {
    String process(Map<String, String> paramMap, Map<String, Object> model);
}
```

ì–´ë–¤ ìƒí™©ì—ì„œ ControllerV3 ë°©ì‹ìœ¼ë¡œ ê°œë°œí•˜ê³  ì‹¶ê³ ,    
ì–´ë–¤ ìƒí™©ì—ì„œ ControllerV4 ë°©ì‹ìœ¼ë¡œ ê°œë°œí•˜ê³  ì‹¶ë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?

ë‘ ì¸í„°í˜ì´ìŠ¤ì˜ ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜ëŠ” ë‹¤ë¥´ë¯€ë¡œ ì´ë¥¼ ë°”ë¡œ ì‚¬ìš©í•˜ê¸°ì—ëŠ” í˜ë“¤ ê²ƒì´ë‹¤.     
ê·¸ëŸ¬ë‚˜ ì´ **ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜ì™€ ìƒê´€ì—†ì´ FrontControllerì™€ í˜¸í™˜ë˜ëŠ” `ì–´ëŒ‘í„°`ê°€ ì¡´ì¬í•œë‹¤ë©´ ì´ë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.**


## âš¡ï¸ V5 êµ¬ì¡°

![v5](https://user-images.githubusercontent.com/50267433/126856391-f1db3e9c-a7ea-4116-90bf-ad1f8f06435a.PNG)

ë‹¤ì–‘í•œ í˜•íƒœì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì§€ì›í•˜ê¸° ìœ„í•œ `Adapter íŒ¨í„´`ì„ ì ‘ëª©ì‹œí‚¨ ê²ƒì´ V5 ëª¨ë¸ì´ë‹¤.

* **í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° :**     
  ì¤‘ê°„ì— ì¶”ê°€ëœ ì–´ëŒ‘í„° ì´ë¦„ì€ **í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°**ì´ë‹¤.       
  í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ëŠ” **ì—°ê²°í•  Controllerì˜ ë©”ì„œë“œ ì‹œê·¸ë‹ˆì²˜ì— ë”°ë¼ ì½”ë“œë¥¼ ì•Œë§ê²Œ ì •ì˜í•´ì£¼ëŠ” ì—­í• ì„ í•œë‹¤.**   
  í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ê°€ í•¸ë“¤ëŸ¬(ì»¨íŠ¸ë¡¤ëŸ¬)ë¥¼ ëŒ€ì‹  í˜¸ì¶œí•´ì£¼ëŠ” ì—­í• ì„ ê°€ì§„ë‹¤.
  ë‹¨, í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„°ê°„ì˜ ê³µí†µ ê·œì•…ì´ ìˆìœ¼ë¯€ë¡œ ì´ë¥¼ ì˜ ë”°ë¥´ë©´ì„œ ì§„í–‰í•´ì•¼ í•œë‹¤.          
  ì–´ëŒ‘í„° ì—­í• ì„ í•´ì£¼ëŠ” ë•ë¶„ì— ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.

* **í•¸ë“¤ëŸ¬ :**
  **ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì´ë¦„ì„ ë” ë„“ì€ ë²”ìœ„ì¸ í•¸ë“¤ëŸ¬ë¡œ ë³€ê²½í–ˆë‹¤.**      
  ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ê°œë… ë¿ë§Œ ì•„ë‹ˆë¼ ì–´ë– í•œ ê²ƒì´ë“  í•´ë‹¹í•˜ëŠ” ì¢…ë¥˜ì˜ ì–´ëŒ‘í„°ë§Œ ìˆìœ¼ë©´ ë‹¤ ì²˜ë¦¬í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.

### ì–´ëŒ‘í„° íŒ¨í„´ (Adapter Pattern)

ì„œë¡œ ë§ì§€ ì•ŠëŠ”(í˜¸í™˜ë˜ì§€ ì•ŠëŠ”) ì¸í„°í˜ì´ìŠ¤ë“¤ì„ ë§ì¶”ëŠ”(ì—°ê²°í•˜ëŠ”) ë””ìì¸ íŒ¨í„´  
ë­”ê°€ 2ê°œê°€ ì•ˆë§ì„ ë•Œ ì¤‘ê°„ì— ë­˜ ë¼ì„œ ë§ì¶”ëŠ”ê±¸ `ì–´ëŒ‘í„° íŒ¨í„´(Adapter Pattern)` ì´ë¼ê³  í•œë‹¤.


<br/>

<br/>


## âš¡ï¸ FrontController
```java
@WebServlet(name = "frontControllerServletV5", urlPatterns = "/front-controller/v5/*")
public class FrontControllerServletV5 extends HttpServlet {

    private final Map<String, Object> handlerMappingMap = new HashMap<>();
    private final List<MyHandlerAdapter> handlerAdapters = new ArrayList<>();

    public FrontControllerServletV5() {
        initHandlerMapping();
        initHandlerAdapter();
    }

    private void initHandlerMapping() {
        handlerMappingMap.put("/front-controller/v5/v3/members/new-form", new MemberFormControllerV3());
        handlerMappingMap.put("/front-controller/v5/v3/members/save", new MemberSaveControllerV3());
        handlerMappingMap.put("/front-controller/v5/v3/members", new MemberListControllerV3());

        handlerMappingMap.put("/front-controller/v5/v4/members/new-form", new MemberFormControllerV4());
        handlerMappingMap.put("/front-controller/v5/v4/members/save", new MemberSaveControllerV4());
        handlerMappingMap.put("/front-controller/v5/v4/members", new MemberListControllerV4());

    }

    private void initHandlerAdapter() {
        handlerAdapters.add(new ControllerV3HandlerAdapter());
        handlerAdapters.add(new ControllerV4HandlerAdapter());
    }

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        Object handler = getHandler(request);

        if (handler == null) {
            response.setStatus(HttpServletResponse.SC_NOT_FOUND);
            return;
        }

        MyHandlerAdapter handlerAdapter = getHandlerAdapter(handler);
        ModelView modelView = handlerAdapter.handle(request, response, handler);
        
        String viewName = modelView.getViewName();// ë…¼ë¦¬ì´ë¦„
        MyView view = viewResolver(viewName);
        
        view.render(modelView.getModel(), request, response);
  }

    private Object getHandler(HttpServletRequest request) {
        String requestURI = request.getRequestURI();
        return handlerMappingMap.get(requestURI);
    }

    private MyHandlerAdapter getHandlerAdapter(Object handler) {
        for (MyHandlerAdapter handlerAdapter : handlerAdapters) {
            if (handlerAdapter.supports(handler)) {
                return handlerAdapter;
            }
        }
        throw new IllegalArgumentException("handler adapterë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. handler=" + handler);
    }

    private MyView viewResolver(String viewName) {
        return new MyView("/WEB-INF/views/" + viewName + ".jsp");
    }

}
```

* `HandlerMapping`ì—ì„œ URLê³¼ ë§¤í•‘ë˜ëŠ” í•¸ë“¤ëŸ¬ë¥¼ ì¡°íšŒí•˜ê³ 
* `HandlerAdapter ëª©ë¡` ì—ì„œ **í•¸ë“¤ëŸ¬ì™€ ì•Œë§ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ì§€ì›í•˜ëŠ” HandlerAdapterë¥¼ ë¶ˆëŸ¬ì™€ ì‹¤í–‰í•œë‹¤**
* `HandlerAdapter`ì˜ ê²°ê³¼ë¡œ ë°˜í™˜ë  ModelViewë¥¼ í†µí•´ ëª¨ë¸ì„ ì„¸íŒ…í•˜ê³  View ë Œë”ë§ì„ ì§„í–‰í•˜ë©´ ëœë‹¤.

<br/>

<br/>

## âš¡ï¸ MyHandlerAdapter
```java
public interface MyHandlerAdapter {

    boolean supports(Object handler);

    ModelView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws ServletException, IOException;
}
```
**í•¸ë“¤ëŸ¬ ì–´ëŒ‘í„° ì¸í„°í˜ì´ìŠ¤**ë¡œ   
Controllerë§ˆë‹¤ ì‚¬ìš©ë˜ëŠ” ì‹œê·¸ë‹ˆì²˜ê°€ ë‹¬ë¼ ì´ë¥¼ êµ¬í˜„í•˜ëŠ” ë¡œì§ì€ ë‹¤ë¥´ì§€ë§Œ,     
ìµœì†Œ ì†Œì¤€ì˜ ê³µí†µ ê·œì•½ì„ ì •í•´ FrontControllerì—ì„œ ì¼ê´€ëœ ë¡œì§ì„ ì‘ì„±í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤€ë‹¤.

**ì‚¬ìš© ê°€ëŠ¥ ìœ ë¬´ íŒë‹¨ ë©”ì„œë“œ**
* `boolean supports(Object handler)`
* handlerëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§í•œë‹¤.
* ì–´ëŒ‘í„°ê°€ í•´ë‹¹ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ”ì§€ íŒë‹¨í•˜ëŠ” ë©”ì„œë“œë‹¤.

**Controller ë¡œì§ ì‹¤í–‰ì„ ìœ„í•œ ë©”ì„œë“œ**
* `ModelView handle(HttpServletRequest request, HttpServletResponse response, Object handler)`
* ì–´ëŒ‘í„°ëŠ” ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•˜ê³ , ê·¸ ê²°ê³¼ë¡œ ModelViewë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤.
* ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ModelViewë¥¼ ë°˜í™˜í•˜ì§€ ëª»í•˜ë©´, ì–´ëŒ‘í„°ê°€ ModelViewë¥¼ ì§ì ‘ ìƒì„±í•´ì„œë¼ë„ ë°˜í™˜í•´ì•¼ í•œë‹¤.
* ì´ì „ì—ëŠ” í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí–ˆì§€ë§Œ ì´ì œëŠ” ì´ ì–´ëŒ‘í„°ë¥¼ í†µí•´ì„œ ì‹¤ì œ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ í˜¸ì¶œëœë‹¤.

<br/>

## âš¡ï¸ ControllerV3HandlerAdapter
```java
public class ControllerV3HandlerAdapter implements MyHandlerAdapter {

    @Override
    public boolean supports(Object handler) {
        return (handler instanceof ControllerV3);
    }

    @Override
    public ModelView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws ServletException, IOException {
        ControllerV3 controller = (ControllerV3) handler;
        return controller.process(paramMap(request));
    }

    private Map<String, String> paramMap(HttpServletRequest request) {
        Map<String, String> paramMap = new HashMap<>();
        request.getParameterNames().asIterator()
                .forEachRemaining(paramName -> paramMap.put(paramName, request.getParameter(paramName)));
        return paramMap;
    }
}
```
ControllerV3ì— ë§ê²Œë” ì½”ë“œë¥¼ êµ¬ì„±í•œ Adapterì´ë‹¤.   
ê·¸ì „ì—ëŠ” FrontControllerì—ì„œ ì§ì ‘ Controllerë¥¼ í˜¸ì¶œí–ˆì§€ë§Œ,   
í˜„ì¬ëŠ” FrontControllerê°€ ì•„ë‹Œ `HandlerAdatper êµ¬í˜„ì²´` ì—ì„œ ì§ì ‘ ì²˜ë¦¬ë¥¼ í•  ê²ƒì´ë©°   
FrontControllerì—ì„œëŠ” requestì™€ View ì„¸íŒ…ì„ í•˜ë„ë¡ ì½”ë“œë¥¼ êµ¬í˜„í•˜ë©´ ëœë‹¤.

<br/>

## âš¡ï¸ ControllerV4HandlerAdapter
```java
public class ControllerV4HandlerAdapter implements MyHandlerAdapter {

    @Override
    public boolean supports(Object handler) {
        return (handler instanceof ControllerV4);
    }

    @Override
    public ModelView handle(HttpServletRequest request, HttpServletResponse response, Object handler) throws ServletException, IOException {
        ControllerV4 controller = (ControllerV4) handler;

        Map<String, String> paramMap = paramMap(request);
        Map<String, Object> model = new HashMap<>();

        String viewName = controller.process(paramMap, model);
        ModelView modelView = new ModelView(viewName);
        modelView.setModel(model);
        return modelView;
    }

    private Map<String, String> paramMap(HttpServletRequest request) {
        Map<String, String> paramMap = new HashMap<>();
        request.getParameterNames().asIterator()
                .forEachRemaining(paramName -> paramMap.put(paramName, request.getParameter(paramName)));
        return paramMap;
    }
}
```
ControllerV4ì— ë§ê²Œë” ì½”ë“œë¥¼ êµ¬ì„±í•œ Adapterì´ë‹¤.   
ê·¸ì „ì—ëŠ” FrontControllerì—ì„œ ì§ì ‘ Controllerë¥¼ í˜¸ì¶œí–ˆì§€ë§Œ,   
í˜„ì¬ëŠ” FrontControllerê°€ ì•„ë‹Œ `HandlerAdatper êµ¬í˜„ì²´` ì—ì„œ ì§ì ‘ ì²˜ë¦¬ë¥¼ í•  ê²ƒì´ë©°   
FrontControllerì—ì„œëŠ” requestì™€ View ì„¸íŒ…ì„ í•˜ë„ë¡ ì½”ë“œë¥¼ êµ¬í˜„í•˜ë©´ ëœë‹¤.

<br/>

<br/>

# ì •ë¦¬
ì§€ê¸ˆê¹Œì§€ v1 ~ v5ë¡œ ì ì§„ì ìœ¼ë¡œ í”„ë ˆì„ì›Œí¬ë¥¼ ë°œì „ì‹œì¼œ ì™”ë‹¤.

* **v1: í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë„ì…**
  * ê¸°ì¡´ êµ¬ì¡°ë¥¼ ìµœëŒ€í•œ ìœ ì§€í•˜ë©´ì„œ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë„ì…
* **v2: View ë¶„ë¥˜**
  * ë‹¨ìˆœ ë°˜ë³µ ë˜ëŠ” ë·° ë¡œì§ ë¶„ë¦¬
* **v3: Model ì¶”ê°€**
  * ì„œë¸”ë¦¿ ì¢…ì†ì„± ì œê±°
  * ë·° ì´ë¦„ ì¤‘ë³µ ì œê±°
* **v4: ë‹¨ìˆœí•˜ê³  ì‹¤ìš©ì ì¸ ì»¨íŠ¸ë¡¤ëŸ¬**
  * v3ì™€ ê±°ì˜ ë¹„ìŠ·
  * êµ¬í˜„ ì…ì¥ì—ì„œ ModelViewë¥¼ ì§ì ‘ ìƒì„±í•´ì„œ ë°˜í™˜í•˜ì§€ ì•Šë„ë¡ í¸ë¦¬í•œ ì¸í„°í˜ì´ìŠ¤ ì œê³µ
* **v5: ìœ ì—°í•œ ì»¨íŠ¸ë¡¤ëŸ¬**
  * ì–´ëŒ‘í„° ë„ì…
  * ì–´ëŒ‘í„°ë¥¼ ì¶”ê°€í•´ì„œ í”„ë ˆì„ì›Œí¬ë¥¼ ìœ ì—°í•˜ê³  í™•ì¥ì„± ìˆê²Œ ì„¤ê³„
  * ì—¬ê¸°ì— ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë” í¸ë¦¬í•˜ê²Œ ë°œì „ì‹œê¸¸ ìˆ˜ë„ ìˆë‹¤.       
    ë§Œì•½ ì• ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ?             
    ë°”ë¡œ **ì• ë…¸í…Œì´ì…˜ì„ ì§€ì›í•˜ëŠ” ì–´ëŒ‘í„°ë¥¼ ì¶”ê°€í•˜ë©´ ëœë‹¤!**
  * ë‹¤í˜•ì„±ê³¼ ì–´ëŒ‘í„° ë•ë¶„ì— ê¸°ì¡´ êµ¬ì¡°ë¥¼ ìœ ì§€í•˜ë©´ì„œ, í”„ë ˆì„ì›Œí¬ì˜ ê¸°ëŠ¥ì„ í™•ì¥í•  ìˆ˜ ìˆë‹¤.

**ìŠ¤í”„ë§ MVC**  
ì—¬ê¸°ì„œ ë” ë°œì „ì‹œí‚¤ë©´ ì¢‹ê² ì§€ë§Œ, ìŠ¤í”„ë§ MVCì˜ í•µì‹¬ êµ¬ì¡°ë¥¼ íŒŒì•…í•˜ëŠ”ë° í•„ìš”í•œ ë¶€ë¶„ì€ ëª¨ë‘ ë§Œë“¤ì–´ë³´ì•˜ë‹¤.   
ì‚¬ì‹¤ì€ ì§€ê¸ˆê¹Œì§€ ì‘ì„±í•œ ì½”ë“œëŠ” ìŠ¤í”„ë§ MVC í”„ë ˆì„ì›Œí¬ì˜ í•µì‹¬ ì½”ë“œì˜ ì¶•ì•½ ë²„ì „ì´ê³ , êµ¬ì¡°ë„ ê±°ì˜ ê°™ë‹¤.     
ìŠ¤í”„ë§ MVCì—ëŠ” ì§€ê¸ˆê¹Œì§€ ìš°ë¦¬ê°€ í•™ìŠµí•œ ë‚´ìš©ê³¼ ê±°ì˜ ê°™ì€ êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆë‹¤      

<br/>

<br/>

<br/>

